function vegaFactory(t,e){function n(t){return t.replace(L,"$1\\'")}function r(t,e,n,r){for(;r>n;){var i=n+r>>>1;S.cmp(t[i],e)<0?n=i+1:r=i}return n}function a(t,e,n){var r=0,i=t.split(z);return(t=n?(i=i.reverse()).filter(function(t){return r+=t.length,e>=r}).reverse():i.filter(function(t){return r+=t.length,e>=r})).length?t.join("").trim():i[0].slice(0,e)}function s(t){S.config.isNode?process.stderr.write(t+"\n"):console.log(t)}function o(t){S.config.isNode?process.stderr.write(t+"\n"):console.error(t)}function u(t){return t.__vgtree__=!0,t.nodes=function(){return l(this,[])},t}function l(t,e){var n,r=t.values,i=r?r.length:0;for(e.push(t),n=0;i>n;++n)l(r[n],e);return e}function c(t){var e,n,r=t;if(S.isArray(t))for(r=[],e=0,n=t.length;n>e;++e)r.push(c(t[e]));else if(S.isObject(t))for(e in r={},t)r[e]=c(t[e]);return r}function h(t,e,n){if(r=[],n&&e.length>1){for(var r,i,a,s=f(t.domain()),o=-1,u=e.length,l=(e[1]-e[0])/++n;++o<u;)for(i=n;--i>0;)(a=+e[o]-i*l)>=s[0]&&r.push(a);for(--o,i=0;++i<n&&(a=+e[o]+i*l)<s[1];)r.push(a)}return r}function f(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function d(t){return t.rangeExtent?t.rangeExtent():f(t.range())}function p(t,e,n,r,i,a){i=Math.max(i,0)+a,("left"===t||"top"===t)&&(i*=-1),"top"===t||"bottom"===t?(S.extend(e.properties.enter,{x:n,y:{value:i}}),S.extend(e.properties.update,{x:r,y:{value:i},align:{value:"center"},baseline:{value:Y[t]}})):(S.extend(e.properties.enter,{x:{value:i},y:n}),S.extend(e.properties.update,{x:{value:i},y:r,align:{value:K[t]},baseline:{value:"middle"}}))}function g(t,e,n,r,i){var a="left"===t||"top"===t?-1:1;i=i===1/0?"top"===t||"bottom"===t?{group:"mark.group.height",mult:-a}:{group:"mark.group.width",mult:-a}:{value:a*i},"top"===t||"bottom"===t?(S.extend(e.properties.enter,{x:n,y:{value:0},y2:i}),S.extend(e.properties.update,{x:r,y:{value:0},y2:i}),S.extend(e.properties.exit,{x:r})):(S.extend(e.properties.enter,{x:{value:0},x2:i,y:n}),S.extend(e.properties.update,{x:{value:0},x2:i,y:r}),S.extend(e.properties.exit,{y:r}))}function v(t,e,n,r){var i=~~((n[0]+n[1])/2),a="top"===t||"left"===t?-1:1;"bottom"===t||"top"===t?S.extend(e.properties.update,{x:{value:i},y:{value:a*r},angle:{value:0}}):S.extend(e.properties.update,{x:{value:a*r},y:{value:i},angle:{value:-90}})}function F(t,e,n,r){var i;("top"===t||"left"===t)&&(r*=-1),i="bottom"===t||"top"===t?"M"+n[0]+","+r+"V0H"+n[1]+"V"+r:"M"+r+","+n[0]+"H0V"+n[1]+"H"+r,e.properties.update.path={value:i}}function m(t,e,n){var r=n?{}:t,i=t.mark.def.offset,a=t.mark.def.orient,s=e.width,o=e.height;if(S.isArray(i)){var u=i[0],l=i[1];switch(a){case"left":r.x=-u,r.y=l;break;case"right":r.x=s+u,r.y=l;break;case"bottom":r.x=u,r.y=o+l;break;case"top":r.x=u,r.y=-l;break;default:r.x=u,r.y=l}}else switch(S.isObject(i)&&(i=-e.scales[i.scale](i.value)),a){case"left":r.x=-i,r.y=0;break;case"right":r.x=s+i,r.y=0;break;case"bottom":r.x=0,r.y=o+i;break;case"top":r.x=0,r.y=-i;break;default:r.x=0,r.y=0}n&&n.interpolate(t,r)}function y(){return{type:"rule",interactive:!1,key:"data",properties:{enter:{stroke:{value:S.config.axis.tickColor},strokeWidth:{value:S.config.axis.tickWidth},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1}}}}}function x(){return{type:"text",interactive:!0,key:"data",properties:{enter:{fill:{value:S.config.axis.tickLabelColor},font:{value:S.config.axis.tickLabelFont},fontSize:{value:S.config.axis.tickLabelFontSize},opacity:{value:1e-6},text:{field:"label"}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1}}}}}function b(){return{type:"text",interactive:!0,properties:{enter:{font:{value:S.config.axis.titleFont},fontSize:{value:S.config.axis.titleFontSize},fontWeight:{value:S.config.axis.titleFontWeight},fill:{value:S.config.axis.titleColor},align:{value:"center"},baseline:{value:"middle"},text:{field:"data"}},update:{}}}}function k(){return{type:"path",interactive:!1,properties:{enter:{x:{value:.5},y:{value:.5},stroke:{value:S.config.axis.axisColor},strokeWidth:{value:S.config.axis.axisWidth}},update:{}}}}function E(t,e,n){var r,i=n?{}:t,a=t.mark.def.offset,s=t.mark.def.orient,o=2*t.mark.def.padding,u=~~t.bounds.width()+(t.width?0:o),l=~~t.bounds.height()+(t.height?0:o);switch(i.x=.5,i.y=.5,i.width=u,i.height=l,!n&&e.bounds&&(e.bounds.delta=e.bounds.x2-e.width),s){case"left":r=e.bounds?e.bounds.x1:0,i.x+=r-a-u;break;case"right":r=e.width,e.bounds&&(r=n?e.width+e.bounds.delta:e.bounds.x2),i.x+=r+a}n&&n.interpolate(t,i),t.mark.def.properties.enter(t,e,n)}function w(t,e,n,r,i){var a=t.properties.enter,s=t.properties.update;e&&(a.size=s.size={scale:e.scaleName,field:"data"}),n&&(a.shape=s.shape={scale:n.scaleName,field:"data"}),r&&(a.fill=s.fill={scale:r.scaleName,field:"data"}),i&&(a.stroke=s.stroke={scale:i.scaleName,field:"data"})}function A(){var t=S.config.legend;return{type:"text",interactive:!1,key:"data",properties:{enter:{x:{value:0},y:{value:0},fill:{value:t.titleColor},font:{value:t.titleFont},fontSize:{value:t.titleFontSize},fontWeight:{value:t.titleFontWeight},baseline:{value:"top"},text:{field:"data"},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1}}}}}function _(){var t=S.config.legend;return{type:"symbol",interactive:!1,key:"data",properties:{enter:{x:{field:"offset",mult:.5},y:{scale:"legend",field:"index"},shape:{value:t.symbolShape},size:{value:t.symbolSize},stroke:{value:t.symbolColor},strokeWidth:{value:t.symbolStrokeWidth},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{x:{field:"offset",mult:.5},y:{scale:"legend",field:"index"},opacity:{value:1}}}}}function C(){var t=S.config.legend;return{type:"text",interactive:!1,key:"data",properties:{enter:{x:{field:"offset",offset:5},y:{scale:"legend",field:"index"},fill:{value:t.labelColor},font:{value:t.labelFont},fontSize:{value:t.labelFontSize},align:{value:t.labelAlign},baseline:{value:t.labelBaseline},text:{field:"label"},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1},x:{field:"offset",offset:5},y:{scale:"legend",field:"index"}}}}}function D(){var t=S.config.legend;return{type:"rect",interactive:!1,properties:{enter:{x:{value:0},y:{value:0},width:{value:t.gradientWidth},height:{value:t.gradientHeight},stroke:{value:t.gradientStrokeColor},strokeWidth:{value:t.gradientStrokeWidth},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{x:{value:0},y:{value:0},opacity:{value:1}}}}}function B(){var t=S.config.legend;return{type:"text",interactive:!1,key:"data",properties:{enter:{x:{scale:"legend",field:"data"},y:{value:20},dy:{value:2},fill:{value:t.labelColor},font:{value:t.labelFont},fontSize:{value:t.labelFontSize},align:{field:"align"},baseline:{value:"top"},text:{field:"label"},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{x:{scale:"legend",field:"data"},y:{value:20},opacity:{value:1}}}}}var S={version:"1.5.0",d3:t,topojson:e},M=Object.prototype.toString;S.isObject=function(t){return t===Object(t)},S.isFunction=function(t){return"[object Function]"==M.call(t)},S.isString=function(t){return"[object String]"==M.call(t)},S.isArray=Array.isArray||function(t){return"[object Array]"==M.call(t)},S.isNumber=function(t){return"[object Number]"==M.call(t)},S.isBoolean=function(t){return"[object Boolean]"==M.call(t)},S.isTree=function(t){return t&&t.__vgtree__},S.tree=function(t,e){var n=[t];return n.__vgtree__=!0,n.children=e||"children",n},S.number=function(t){return+t},S.boolean=function(t){return!!t},S.startsWith=String.prototype.startsWith?function(t,e){return t.startsWith(e)}:function(t,e){return 0===t.lastIndexOf(e,0)},S.identity=function(t){return t},S["true"]=function(){return!0},S.extend=function(t){for(var e,n,r=1,i=arguments.length;i>r;++r)for(n in e=arguments[r])t[n]=e[n];return t},S.duplicate=function(t){return JSON.parse(JSON.stringify(t))},S.field=function(t){return t.split("\\.").map(function(t){return t.split(".")}).reduce(function(t,e){return t.length&&(t[t.length-1]+="."+e.shift()),t.push.apply(t,e),t},[])},S.accessor=function(t){var e;return S.isFunction(t)||null==t?t:S.isString(t)&&(e=S.field(t)).length>1?function(t){return e.reduce(function(t,e){return t[e]},t)}:function(e){return e[t]}},S.mutator=function(t){var e;return S.isString(t)&&(e=S.field(t)).length>1?function(t,n){for(var r=0;r<e.length-1;++r)t=t[e[r]];t[e[r]]=n}:function(e,n){e[t]=n}},S.comparator=function(t){var e=[];return void 0===t&&(t=[]),t=S.array(t).map(function(t){var n=1;return"-"===t[0]?(n=-1,t=t.slice(1)):"+"===t[0]&&(n=1,t=t.slice(1)),e.push(n),S.accessor(t)}),function(n,r){var i,a,s,o,u;for(i=0,a=t.length;a>i;++i){if(o=(s=t[i])(n),(u=s(r))>o)return-1*e[i];if(o>u)return e[i]}return 0}},S.cmp=function(t,e){return e>t?-1:t>e?1:t>=e?0:null===t&&null===e?0:null===t?-1:null===e?1:NaN},S.numcmp=function(t,e){return t-e},S.array=function(t){return null!=t?S.isArray(t)?t:[t]:[]},S.values=function(t){return S.isObject(t)&&!S.isArray(t)&&t.values?t.values:t},S.str=function(t){return S.isArray(t)?"["+t.map(S.str)+"]":S.isObject(t)?JSON.stringify(t):S.isString(t)?"'"+n(t)+"'":t};var L=/(^|[^\\])'/g;S.keys=function(t){var e=[];for(var n in t)e.push(n);return e},S.toMap=function(t){return t.reduce(function(t,e){return t[e]=1,t},{})},S.unique=function(t,e,n){if(!S.isArray(t)||0===t.length)return[];e=e||S.identity,n=n||[];for(var r,i={},a=0,s=t.length;s>a;++a)(r=e(t[a]))in i||(i[r]=!0,n.push(r));return n},S.minIndex=function(t,e){if(!S.isArray(t)||0==t.length)return-1;for(var n=0,r=(e=e||S.identity)(t[0]),i=r,a=1,s=t.length;s>a;++a)r>(i=e(t[a]))&&(r=i,n=a);return n},S.maxIndex=function(t,e){if(!S.isArray(t)||0==t.length)return-1;for(var n=0,r=(e=e||S.identity)(t[0]),i=r,a=1,s=t.length;s>a;++a)(i=e(t[a]))>r&&(r=i,n=a);return n},S.bins=function(t){var e,n,i,a,s=(t=t||{}).maxbins||1024,o=t.base||10,u=t.div||[5,2],l=t.minstep||0,c=Math.log(o),h=Math.ceil(Math.log(s)/c),f=t.min,d=t.max,p=d-f,g=Math.max(l,Math.pow(o,Math.round(Math.log(p)/c)-h)),v=Math.ceil(p/g);if(null!=t.step)g=t.step;else if(t.steps)g=t.steps[Math.min(t.steps.length-1,r(t.steps,p/s,0,t.steps.length))];else{do{g*=o,v=Math.ceil(p/g)}while(v>s);for(i=0;i<u.length;++i)(n=g/u[i])>=l&&s>=p/n&&(g=n,v=Math.ceil(p/g))}return e=(n=Math.log(g))>=0?0:1+~~(-n/c),a=(0>f?-1:1)*Math.pow(o,-e-1),{start:f=Math.min(f,Math.floor(f/g+a)*g),stop:d=Math.ceil(d/g)*g,step:g,unit:e}},S.truncate=function(t,e,n,r,i){var s=t.length;if(e>=s)return t;i=i||"...";var o=Math.max(0,e-i.length);switch(n){case"left":return i+(r?a(t,o,1):t.slice(s-o));case"middle":case"center":var u=Math.ceil(o/2),l=Math.floor(o/2);return(r?a(t,u):t.slice(0,u))+i+(r?a(t,l,1):t.slice(s-l));default:return(r?a(t,o):t.slice(0,o))+i}};var z=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/;S.log=function(t){s("[Vega Log] "+t)},S.error=function(t){o("[Vega Err] "+t)},S.config={},S.config.isNode=!1,S.config.domainWhiteList=!1,S.config.safeMode=!1,S.config.baseURL="",S.config.defaultProtocol="http:",S.config.svgNamespace='version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"',S.config.autopadInset=5,S.config.scale={time:t.time.scale,utc:t.time.scale.utc},S.config.render={lineWidth:1,lineCap:"butt",font:"sans-serif",fontSize:11},S.config.axis={orient:"bottom",ticks:10,padding:3,axisColor:"#000",gridColor:"#d8d8d8",tickColor:"#000",tickLabelColor:"#000",axisWidth:1,tickWidth:1,tickSize:6,tickLabelFontSize:11,tickLabelFont:"sans-serif",titleColor:"#000",titleFont:"sans-serif",titleFontSize:11,titleFontWeight:"bold",titleOffset:35},S.config.legend={orient:"right",offset:10,padding:3,gradientStrokeColor:"#888",gradientStrokeWidth:1,gradientHeight:16,gradientWidth:100,labelColor:"#000",labelFontSize:10,labelFont:"sans-serif",labelAlign:"left",labelBaseline:"middle",labelOffset:8,symbolShape:"circle",symbolSize:50,symbolColor:"#888",symbolStrokeWidth:1,titleColor:"#000",titleFont:"sans-serif",titleFontSize:11,titleFontWeight:"bold"},S.config.color={rgb:[128,128,128],lab:[50,0,0],hcl:[0,0,50],hsl:[0,0,.5]},S.config.range={category10:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],category20:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],shapes:["circle","cross","diamond","square","triangle-down","triangle-up"]},S.Bounds=function(){var t=function(t){this.clear(),t&&this.union(t)},e=t.prototype;return e.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},e.set=function(t,e,n,r){return this.x1=t,this.y1=e,this.x2=n,this.y2=r,this},e.add=function(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},e.expand=function(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},e.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},e.translate=function(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},e.rotate=function(t,e,n){var r=Math.cos(t),i=Math.sin(t),a=e-e*r+n*i,s=n-e*i-n*r,o=this.x1,u=this.x2,l=this.y1,c=this.y2;return this.clear().add(r*o-i*l+a,i*o+r*l+s).add(r*o-i*c+a,i*o+r*c+s).add(r*u-i*l+a,i*u+r*l+s).add(r*u-i*c+a,i*u+r*c+s)},e.union=function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},e.encloses=function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},e.intersects=function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},e.contains=function(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},e.width=function(){return this.x2-this.x1},e.height=function(){return this.y2-this.y1},t}(),S.Gradient=function(){function t(t){this.id="grad_"+I++,this.type=t||"linear",this.stops=[],this.x1=0,this.x2=1,this.y1=0,this.y2=0}return t.prototype.stop=function(t,e){return this.stops.push({offset:t,color:e}),this},t}();var I=0;S.canvas={},S.canvas.path=function(){function e(t){for(var e,n,r,i,a=[],s=0,o=(t=t.slice().replace(f[0],"###$1").split(f[1]).slice(1)).length;o>s;s++){n=(e=t[s]).slice(1).trim().replace(f[2],"$1###-").split(f[3]),i=[e.charAt(0)];for(var u=0,l=n.length;l>u;u++)r=parseFloat(n[u]),isNaN(r)||i.push(r);var c=i[0].toLowerCase(),d=h[c];if(i.length-1>d)for(var p=1,g=i.length;g>p;p+=d)a.push([i[0]].concat(i.slice(p,p+d)));else a.push(i)}return a}function n(t,e,n,r,s,o,u){for(var l=r[0],c=r[1],h=r[2],f=r[3],d=r[4],p=i(r[5],r[6],l,c,f,d,h,e,n),g=0;g<p.length;g++){var v=a.apply(null,p[g]);t.bezierCurveTo.apply(t,v),s.add(v[0]-o,v[1]-u),s.add(v[2]-o,v[3]-u),s.add(v[4]-o,v[5]-u)}}function r(t,e,n,r){for(var s=n[0],o=n[1],u=n[2],l=n[3],c=n[4],h=i(n[5],n[6],s,o,l,c,u,t,e),f=0;f<h.length;f++){var d=a.apply(null,h[f]);r.add(d[0],d[1]),r.add(d[2],d[3]),r.add(d[4],d[5])}}function i(t,e,n,r,i,a,s,o,u){if(c=g.call(arguments),d[c])return d[c];var l=s*(Math.PI/180),h=Math.sin(l),f=Math.cos(l),p=f*(o-t)*.5+h*(u-e)*.5,v=f*(u-e)*.5-h*(o-t)*.5,F=p*p/((n=Math.abs(n))*n)+v*v/((r=Math.abs(r))*r);F>1&&(n*=F=Math.sqrt(F),r*=F);var m=f/n,y=h/n,x=-h/r,b=f/r,k=m*o+y*u,E=x*o+b*u,w=m*t+y*e,A=x*t+b*e,_=1/((w-k)*(w-k)+(A-E)*(A-E))-.25;0>_&&(_=0);var C=Math.sqrt(_);a==i&&(C=-C);var D=.5*(k+w)-C*(A-E),B=.5*(E+A)+C*(w-k),S=Math.atan2(E-B,k-D),M=Math.atan2(A-B,w-D)-S;0>M&&1==a?M+=2*Math.PI:M>0&&0==a&&(M-=2*Math.PI);for(var L=Math.ceil(Math.abs(M/(.5*Math.PI+.001))),z=[],I=0;L>I;I++){var P=S+I*M/L,T=S+(I+1)*M/L;z[I]=[D,B,P,T,n,r,h,f]}return d[c]=z}function a(t,e,n,r,i,a,s,o){if(c=g.call(arguments),p[c])return p[c];var u=o*i,l=-s*a,h=s*i,f=o*a,d=Math.cos(n),v=Math.sin(n),F=Math.cos(r),m=Math.sin(r),y=.5*(r-n),x=Math.sin(.5*y),b=8/3*x*x/Math.sin(y),k=t+d-b*v,E=e+v+b*d,w=t+F,A=e+m,_=w+b*m,C=A-b*F;return p[c]=[u*k+l*E,h*k+f*E,u*_+l*C,h*_+f*C,u*w+l*A,h*w+f*A]}function s(t,e,r,i){var a,s,o,u,l,c=null,h=0,f=0,d=0,p=0,g=new S.Bounds;null==r&&(r=0),null==i&&(i=0),t.beginPath();for(var v=0,F=e.length;F>v;++v){switch((a=e[v])[0]){case"l":h+=a[1],f+=a[2],t.lineTo(h+r,f+i),g.add(h,f);break;case"L":h=a[1],f=a[2],t.lineTo(h+r,f+i),g.add(h,f);break;case"h":h+=a[1],t.lineTo(h+r,f+i),g.add(h,f);break;case"H":h=a[1],t.lineTo(h+r,f+i),g.add(h,f);break;case"v":f+=a[1],t.lineTo(h+r,f+i),g.add(h,f);break;case"V":f=a[1],t.lineTo(h+r,f+i),g.add(h,f);break;case"m":h+=a[1],f+=a[2],t.moveTo(h+r,f+i),g.add(h,f);break;case"M":h=a[1],f=a[2],t.moveTo(h+r,f+i),g.add(h,f);break;case"c":s=h+a[5],o=f+a[6],d=h+a[3],p=f+a[4],t.bezierCurveTo(h+a[1]+r,f+a[2]+i,d+r,p+i,s+r,o+i),g.add(h+a[1],f+a[2]),g.add(d,p),g.add(s,o),h=s,f=o;break;case"C":h=a[5],f=a[6],d=a[3],p=a[4],t.bezierCurveTo(a[1]+r,a[2]+i,d+r,p+i,h+r,f+i),g.add(a[1],a[2]),g.add(d,p),g.add(h,f);break;case"s":s=h+a[3],o=f+a[4],d=2*h-d,p=2*f-p,t.bezierCurveTo(d+r,p+i,h+a[1]+r,f+a[2]+i,s+r,o+i),g.add(d,p),g.add(h+a[1],f+a[2]),g.add(s,o),d=h+a[1],p=f+a[2],h=s,f=o;break;case"S":s=a[3],o=a[4],d=2*h-d,p=2*f-p,t.bezierCurveTo(d+r,p+i,a[1]+r,a[2]+i,s+r,o+i),h=s,f=o,g.add(a[1],a[2]),g.add(d,p),g.add(s,o),d=a[1],p=a[2];break;case"q":s=h+a[3],o=f+a[4],d=h+a[1],p=f+a[2],t.quadraticCurveTo(d+r,p+i,s+r,o+i),h=s,f=o,g.add(d,p),g.add(s,o);break;case"Q":s=a[3],o=a[4],t.quadraticCurveTo(a[1]+r,a[2]+i,s+r,o+i),h=s,f=o,d=a[1],p=a[2],g.add(d,p),g.add(s,o);break;case"t":s=h+a[1],o=f+a[2],null===c[0].match(/[QqTt]/)?(d=h,p=f):"t"===c[0]?(d=2*h-u,p=2*f-l):"q"===c[0]&&(d=2*h-d,p=2*f-p),u=d,l=p,t.quadraticCurveTo(d+r,p+i,s+r,o+i),f=o,d=(h=s)+a[1],p=f+a[2],g.add(d,p),g.add(s,o);break;case"T":s=a[1],o=a[2],d=2*h-d,p=2*f-p,t.quadraticCurveTo(d+r,p+i,s+r,o+i),h=s,f=o,g.add(d,p),g.add(s,o);break;case"a":n(t,h+r,f+i,[a[1],a[2],a[3],a[4],a[5],a[6]+h+r,a[7]+f+i],g,r,i),h+=a[6],f+=a[7];break;case"A":n(t,h+r,f+i,[a[1],a[2],a[3],a[4],a[5],a[6]+r,a[7]+i],g,r,i),h=a[6],f=a[7];break;case"z":case"Z":t.closePath()}c=a}return g.translate(r,i)}function o(t,e){for(var n,i,a,s,o,u=null,l=0,c=0,h=0,f=0,d=0,p=t.length;p>d;++d){switch((n=t[d])[0]){case"l":l+=n[1],c+=n[2],e.add(l,c);break;case"L":l=n[1],c=n[2],e.add(l,c);break;case"h":l+=n[1],e.add(l,c);break;case"H":l=n[1],e.add(l,c);break;case"v":c+=n[1],e.add(l,c);break;case"V":c=n[1],e.add(l,c);break;case"m":l+=n[1],c+=n[2],e.add(l,c);break;case"M":l=n[1],c=n[2],e.add(l,c);break;case"c":i=l+n[5],a=c+n[6],h=l+n[3],f=c+n[4],e.add(l+n[1],c+n[2]),e.add(h,f),e.add(i,a),l=i,c=a;break;case"C":l=n[5],c=n[6],h=n[3],f=n[4],e.add(n[1],n[2]),e.add(h,f),e.add(l,c);break;case"s":i=l+n[3],a=c+n[4],h=2*l-h,f=2*c-f,e.add(h,f),e.add(l+n[1],c+n[2]),e.add(i,a),h=l+n[1],f=c+n[2],l=i,c=a;break;case"S":h=2*l-h,f=2*c-f,l=i=n[3],c=a=n[4],e.add(n[1],n[2]),e.add(h,f),e.add(i,a),h=n[1],f=n[2];break;case"q":i=l+n[3],a=c+n[4],h=l+n[1],f=c+n[2],l=i,c=a,e.add(h,f),e.add(i,a);break;case"Q":l=i=n[3],c=a=n[4],h=n[1],f=n[2],e.add(h,f),e.add(i,a);break;case"t":i=l+n[1],a=c+n[2],null===u[0].match(/[QqTt]/)?(h=l,f=c):"t"===u[0]?(h=2*l-s,f=2*c-o):"q"===u[0]&&(h=2*l-h,f=2*c-f),s=h,o=f,c=a,h=(l=i)+n[1],f=c+n[2],e.add(h,f),e.add(i,a);break;case"T":h=2*l-h,f=2*c-f,l=i=n[1],c=a=n[2],e.add(h,f),e.add(i,a);break;case"a":r(l,c,[n[1],n[2],n[3],n[4],n[5],n[6]+l,n[7]+c],e),l+=n[6],c+=n[7];break;case"A":r(l,c,[n[1],n[2],n[3],n[4],n[5],n[6],n[7]],e),l=n[6],c=n[7]}u=n}return e}function u(e){var n,r=e[0];return n="horizontal"===r.orient?t.svg.area().y(function(t){return t.y}).x0(function(t){return t.x}).x1(function(t){return t.x+t.width}):t.svg.area().x(function(t){return t.x}).y1(function(t){return t.y}).y0(function(t){return t.y+t.height}),r.interpolate&&n.interpolate(r.interpolate),null!=r.tension&&n.tension(r.tension),n(e)}function l(e){var n=e[0],r=t.svg.line().x(function(t){return t.x}).y(function(t){return t.y});return n.interpolate&&r.interpolate(n.interpolate),null!=n.tension&&r.tension(n.tension),r(e)}var c,h={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},f=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)-/g,/\s|,|###/],d={},p={},g=Array.prototype.join;return{parse:e,render:s,bounds:o,area:u,line:l}}(),S.canvas.marks=function(){function t(t,e){var n=e.x||0,r=e.y||0,i=e.innerRadius||0,a=e.outerRadius||0,s=(e.startAngle||0)-Math.PI/2,o=(e.endAngle||0)-Math.PI/2;t.beginPath(),0===i?t.moveTo(n,r):t.arc(n,r,i,s,o,0),t.arc(n,r,a,o,s,1),t.closePath()}function e(t,e){var n=e[0].mark,r=n.pathCache||(n.pathCache=w(S.canvas.path.area(e)));A(t,r)}function n(t,e){var n=e[0].mark,r=n.pathCache||(n.pathCache=w(S.canvas.path.line(e)));A(t,r)}function r(t,e){if(null!=e.path){var n=e.pathCache||(e.pathCache=w(e.path));return A(t,n,e.x,e.y)}}function i(t,e){t.beginPath();var n,r,i,a,s=null!=e.size?e.size:100,o=e.x,u=e.y;if(null==e.shape||"circle"===e.shape)return n=Math.sqrt(s/Math.PI),t.arc(o,u,n,0,2*Math.PI,0),void t.closePath();switch(e.shape){case"cross":r=3*(n=Math.sqrt(s/5)/2),t.moveTo(o-r,u-n),t.lineTo(o-n,u-n),t.lineTo(o-n,u-r),t.lineTo(o+n,u-r),t.lineTo(o+n,u-n),t.lineTo(o+r,u-n),t.lineTo(o+r,u+n),t.lineTo(o+n,u+n),t.lineTo(o+n,u+r),t.lineTo(o-n,u+r),t.lineTo(o-n,u+n),t.lineTo(o-r,u+n);break;case"diamond":i=(a=Math.sqrt(s/(2*C)))*C,t.moveTo(o,u-a),t.lineTo(o+i,u),t.lineTo(o,u+a),t.lineTo(o-i,u);break;case"square":n=(r=Math.sqrt(s))/2,t.rect(o-n,u-n,r,r);break;case"triangle-down":a=(i=Math.sqrt(s/_))*_/2,t.moveTo(o,u+a),t.lineTo(o+i,u-a),t.lineTo(o-i,u-a);break;case"triangle-up":a=(i=Math.sqrt(s/_))*_/2,t.moveTo(o,u-a),t.lineTo(o+i,u+a),t.lineTo(o-i,u+a)}t.closePath()}function a(t,e){var r=e[0],i=r.strokeWidth,a=r.strokeCap;t.lineWidth=null!=i?i:S.config.render.lineWidth,t.lineCap=null!=a?a:S.config.render.lineCap,n(t,e)}function s(t,e){var n=e.x||0,r=e.y||0,i=null!=e.x2?e.x2:n,a=null!=e.y2?e.y2:r,s=e.strokeWidth,o=e.strokeCap;t.lineWidth=null!=s?s:S.config.render.lineWidth,t.lineCap=null!=o?o:S.config.render.lineCap,t.beginPath(),t.moveTo(n,r),t.lineTo(i,a)}function o(t,e,n,r){var i,a,s,o=n.fill,u=n.stroke;t(e,r),0!=(i=null==n.opacity?1:n.opacity)&&(o||u)&&(o&&(e.globalAlpha=i*(null==n.fillOpacity?1:n.fillOpacity),e.fillStyle=v(e,n,o),e.fill()),u&&((s=null!=(s=n.strokeWidth)?s:S.config.render.lineWidth)>0&&(e.globalAlpha=i*(null==n.strokeOpacity?1:n.strokeOpacity),e.strokeStyle=v(e,n,u),e.lineWidth=s,e.lineCap=null!=(a=n.strokeCap)?a:S.config.render.lineCap,e.vgLineDash(n.strokeDash||null),e.vgLineDashOffset(n.strokeDashOffset||0),e.stroke())))}function u(t,e,n,r){var i,a,s;for(i=0,a=n.items.length;a>i;++i)s=n.items[i],(!r||r.intersects(s.bounds))&&o(t,e,s,s)}function l(t,e,n){if(e.items.length)for(var r,i,a,s,o,u,l,c,h,f,d=e.items,p=0,g=d.length;g>p;++p)r=d[p],(!n||n.intersects(r.bounds))&&(l=r.x||0,c=r.y||0,h=r.width||0,f=r.height||0,0!=(s=null==r.opacity?1:r.opacity)&&((i=r.fill)&&(t.globalAlpha=s*(null==r.fillOpacity?1:r.fillOpacity),t.fillStyle=v(t,r,i),t.fillRect(l,c,h,f)),(a=r.stroke)&&((u=null!=(u=r.strokeWidth)?u:S.config.render.lineWidth)>0&&(t.globalAlpha=s*(null==r.strokeOpacity?1:r.strokeOpacity),t.strokeStyle=v(t,r,a),t.lineWidth=u,t.lineCap=null!=(o=r.strokeCap)?o:S.config.render.lineCap,t.vgLineDash(r.strokeDash||null),t.vgLineDashOffset(r.strokeDashOffset||0),t.strokeRect(l,c,h,f)))))}function c(t,e,n){if(e.items.length)for(var r,i,a,s,o,u,l,c,h,f=e.items,d=0,p=f.length;p>d;++d)r=f[d],(!n||n.intersects(r.bounds))&&(u=r.x||0,l=r.y||0,c=null!=r.x2?r.x2:u,h=null!=r.y2?r.y2:l,0!=(a=null==r.opacity?1:r.opacity)&&(i=r.stroke)&&((o=null!=(o=r.strokeWidth)?o:S.config.render.lineWidth)>0&&(t.globalAlpha=a*(null==r.strokeOpacity?1:r.strokeOpacity),t.strokeStyle=v(t,r,i),t.lineWidth=o,t.lineCap=null!=(s=r.strokeCap)?s:S.config.render.lineCap,t.vgLineDash(r.strokeDash||null),t.vgLineDashOffset(r.strokeDashOffset||0),t.beginPath(),t.moveTo(u,l),t.lineTo(c,h),t.stroke())))}function h(t,e,n){if(e.items.length)for(var r,i=this,a=e.items,s=0,o=a.length;o>s;++s)if(r=a[s],!n||n.intersects(r.bounds)){var u,l,c,h,f;r.image&&r.image.url===r.url||(r.image=i.loadImage(r.url),r.image.url=r.url),c=r.width||r.image&&r.image.width||0,h=r.height||r.image&&r.image.height||0,u=(r.x||0)-("center"===r.align?c/2:"right"===r.align?c:0),l=(r.y||0)-("middle"===r.baseline?h/2:"bottom"===r.baseline?h:0),r.image.loaded&&(t.globalAlpha=null!=(f=r.opacity)?f:1,t.drawImage(r.image,u,l,c,h))}}function f(t,e,n){if(e.items.length)for(var r,i,a,s,o,u,l,c,h,f=e.items,d=0,p=f.length;p>d;++d)r=f[d],(!n||n.intersects(r.bounds))&&(t.font=S.scene.fontString(r),t.textAlign=r.align||"left",t.textBaseline=r.baseline||"alphabetic",0!=(s=null==r.opacity?1:r.opacity)&&(u=r.x||0,l=r.y||0,(c=r.radius)&&(h=(r.theta||0)-Math.PI/2,u+=c*Math.cos(h),l+=c*Math.sin(h)),r.angle?(t.save(),t.translate(u,l),t.rotate(r.angle*Math.PI/180),u=r.dx||0,l=r.dy||0):(u+=r.dx||0,l+=r.dy||0),(i=r.fill)&&(t.globalAlpha=s*(null==r.fillOpacity?1:r.fillOpacity),t.fillStyle=v(t,r,i),t.fillText(r.text,u,l)),(a=r.stroke)&&((o=null!=(o=r.strokeWidth)?o:1)>0&&(t.globalAlpha=s*(null==r.strokeOpacity?1:r.strokeOpacity),t.strokeStyle=v(r,a),t.lineWidth=o,t.strokeText(r.text,u,l))),r.angle&&t.restore()))}function d(t){return function(e,n,r){u(t,e,n,r)}}function p(t){return function(e,n,r){n.items.length&&(!r||r.intersects(n.items[0].bounds))&&o(t,e,n.items[0],n.items)}}function g(t,e,n){if(e.items.length){var r,i,a,s,o,u,c,h,f,d=e.items,p=this;for(l(t,e,n),u=0,c=d.length;c>u;++u){for(i=(r=d[u]).axisItems||[],a=r.legendItems||[],s=r.x||0,o=r.y||0,t.save(),t.translate(s,o),r.clip&&(t.beginPath(),t.rect(0,0,r.width||0,r.height||0),t.clip()),n&&n.translate(-s,-o),h=0,f=i.length;f>h;++h)"back"===i[h].def.layer&&p.draw(t,i[h],n);for(h=0,f=r.items.length;f>h;++h)p.draw(t,r.items[h],n);for(h=0,f=i.length;f>h;++h)"back"!==i[h].def.layer&&p.draw(t,i[h],n);for(h=0,f=a.length;f>h;++h)p.draw(t,a[h],n);n&&n.translate(s,o),t.restore()}}}function v(t,e,n){return n.id?F(t,n,e.bounds):n}function F(t,e,n){var r,i,a=n.width(),s=n.height(),o=n.x1+e.x1*a,u=n.y1+e.y1*s,l=n.x1+e.x2*a,c=n.y1+e.y2*s,h=t.createLinearGradient(o,u,l,c),f=e.stops;for(r=0,i=f.length;i>r;++r)h.addColorStop(f[r].offset,f[r].color);return h}function m(t,e,n,r,i,a){if(0===e.items.length||e.bounds&&!e.bounds.contains(i,a))return!1;var s,o,u,l,c,h,f,d=e.items,p=this;for(h=d.length;--h>=0;){for(l=(o=d[h]).x||0,c=o.y||0,t.save(),t.translate(l,c),f=o.items.length;--f>=0;)if(!1!==(s=o.items[f]).interactive&&(u=p.pick(s,n,r,i-l,a-c)))return t.restore(),u;t.restore()}return!!e.interactive&&y(B.group,t,e,n,r,i,a)}function y(t,e,n,r,i,a,s){if(!n.items.length)return!1;var o,u,l;for(1!==e._ratio&&(r*=e._ratio,i*=e._ratio),l=n.items.length;--l>=0;)if((!(u=(o=n.items[l]).bounds)||u.contains(a,s))&&u&&t(e,o,r,i,a,s))return o;return!1}function x(t,e,n,r,i,a){if(!e.items.length)return!1;var s,o=e.items;return!((s=o[0].bounds)&&!s.contains(i,a))&&(1!==t._ratio&&(n*=t._ratio,r*=t._ratio),!!B.area(t,o,n,r)&&o[0])}function b(t,e,n,r,i,a){if(!e.items.length)return!1;var s,o=e.items;return!((s=o[0].bounds)&&!s.contains(i,a))&&(1!==t._ratio&&(n*=t._ratio,r*=t._ratio),!!B.line(t,o,n,r)&&o[0])}function k(t){return function(e,n,r,i,a,s){return y(t,e,n,r,i,a,s)}}function E(t,e,n,r,i,a){if(!e.fontSize)return!1;if(!e.angle)return!0;var s=S.scene.bounds.text(e,D,!0),o=-e.angle*Math.PI/180,u=Math.cos(o),l=Math.sin(o),c=u*i-l*a+((n=e.x)-n*u+(r=e.y)*l),h=l*i+u*a+(r-n*l-r*u);return s.contains(c,h)}var w=S.canvas.path.parse,A=S.canvas.path.render,_=(Math.PI,Math.sqrt(3)),C=Math.tan(30*Math.PI/180),D=new S.Bounds,B={text:E,rect:function(){return!0},image:function(){return!0},group:function(t,e){return e.fill||e.stroke},rule:function(t,e,n,r){return!!t.isPointInStroke&&(s(t,e),t.isPointInStroke(n,r))},line:function(t,e,n,r){return!!t.isPointInStroke&&(a(t,e),t.isPointInStroke(n,r))},arc:function(e,n,r,i){return t(e,n),e.isPointInPath(r,i)},area:function(t,n,r,i){return e(t,n),t.isPointInPath(r,i)},path:function(t,e,n,i){return r(t,e),t.isPointInPath(n,i)},symbol:function(t,e,n,r){return i(t,e),t.isPointInPath(n,r)}};return{draw:{group:g,area:p(e),line:p(n),arc:d(t),path:d(r),symbol:d(i),rect:l,rule:c,text:f,image:h,drawOne:p,drawAll:d},pick:{group:m,area:x,line:b,arc:k(B.arc),path:k(B.path),symbol:k(B.symbol),rect:k(B.rect),rule:k(B.rule),text:k(B.text),image:k(B.image),pickAll:y}}}(),S.canvas.Renderer=function(){function e(t,e){var n=window.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,i=n/r;if(n!==r){var a=t.width,s=t.height;t.setAttribute("width",a*i),t.setAttribute("height",s*i),t.style.width=a+"px",t.style.height=s+"px"}return i}function n(t){if(!t.vgLineDash){var e=[];t.setLineDash?(t.vgLineDash=function(t){this.setLineDash(t||e)},t.vgLineDashOffset=function(t){this.lineDashOffset=t}):void 0!==t.webkitLineDash?(t.vgLineDash=function(t){this.webkitLineDash=t||e},t.vgLineDashOffset=function(t){this.webkitLineDashOffset=t}):void 0!==t.mozDash?(t.vgLineDash=function(t){this.mozDash=t},t.vgLineDashOffset=function(){}):(t.vgLineDash=function(){},t.vgLineDashOffset=function(){})}}function r(t,e){for(var n=new S.Bounds(e);null!=(t=t.mark.group);)n.translate(t.x||0,t.y||0);return n}function i(t){return t?S.array(t).reduce(function(t,e){return t.union(r(e,e.bounds)).union(r(e,e["bounds:prev"]))},new S.Bounds):null}function a(t,e){var n=null;return e&&(n=new S.Bounds(e).round(),t.beginPath(),t.rect(n.x1,n.y1,n.width(),n.height()),t.clip()),n}var s=function(){this._ctx=null,this._el=null,this._bgcolor=null,this._imgload=0},o=s.prototype;return o.initialize=function(e,n,r,i,a){if(this._el=e,this.background(a),!e)return this;var s=t.select(e).selectAll("canvas.marks").data([1]);return s.enter().append("canvas").attr("class","marks"),s.exit().remove(),this.resize(n,r,i)},o.background=function(t){return this._bgcolor=t,this},o.resize=function(r,i,a){if(this._width=r,this._height=i,this._padding=a,this._el){var s,o=t.select(this._el).select("canvas.marks");o.attr("width",r+a.left+a.right).attr("height",i+a.top+a.bottom),this._ctx=o.node().getContext("2d"),this._ctx._ratio=s=e(o.node(),this._ctx)||1,this._ctx.setTransform(s,0,0,s,s*a.left,s*a.top)}return n(this._ctx),this},o.context=function(t){return t?(this._ctx=t,this):this._ctx},o.element=function(){return this._el},o.pendingImages=function(){return this._imgload},o.render=function(t,e){var n,r=this._ctx,s=this._padding,o=this._width+s.left+s.right,u=this._height+s.top+s.bottom,l=null;this._scene=t,r.save(),l=a(r,i(e)),this.clear(-s.left,-s.top,o,u),this.draw(r,t,l),e&&(r.restore(),r.save(),n=a(r,i(e)),l.encloses(n)||(this.clear(-s.left,-s.top,o,u),this.draw(r,t,n))),r.restore(),this._scene=null},o.draw=function(t,e,n){var r=e.marktype;S.canvas.marks.draw[r].call(this,t,e,n)},o.clear=function(t,e,n,r){var i=this._ctx;i.clearRect(t,e,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(t,e,n,r))},o.renderAsync=function(t){var e=this;e._async_id&&clearTimeout(e._async_id),e._async_id=setTimeout(function(){e.render(t),delete e._async_id},50)},o.loadImage=function(t){var e,n=this,r=n._scene,i=null;if(S.config.isNode)n._imgload+=1,i=new(require("canvas").Image),S.data.load(t,function(e,r){return n._imgload-=1,e?void S.error(e):(S.log("LOAD IMAGE: "+t),i.src=r,void(i.loaded=!0))});else{if(i=new Image,!(e=S.data.load.sanitizeUrl(t)))return;n._imgload+=1,i.onload=function(){S.log("LOAD IMAGE: "+e),i.loaded=!0,n._imgload-=1,n.renderAsync(r)},i.src=e}return i},s}(),S.canvas.Handler=function(){function e(t){var e=t.indexOf(".");return 0>e?t:t.slice(0,e)}var n=function(t,e){this._active=null,this._down=null,this._handlers={},t&&this.initialize(t),e&&this.model(e)},r=n.prototype;r.initialize=function(e,n,a){this._el=t.select(e).node(),this._canvas=t.select(e).select("canvas.marks").node(),this._padding=n,this._obj=a||null;var s=this._canvas,o=this;return i.forEach(function(t){s.addEventListener(t,function(e){r[t].call(o,e)})}),this},r.padding=function(t){return this._padding=t,this},r.model=function(t){return arguments.length?(this._model=t,this):this._model},r.handlers=function(){var t=this._handlers;return S.keys(t).reduce(function(e,n){return t[n].reduce(function(t,e){return t.push(e),t},e)},[])};var i=["mouseup","dblclick","wheel","keydown","keypress","keyup","mousewheel"];return i.forEach(function(t){r[t]=function(e){this.fire(t,e)}}),i.push("mousedown"),i.push("mousemove"),i.push("mouseout"),i.push("click"),r.mousemove=function(t){var e=this._padding,n=t.target.getBoundingClientRect(),r=t.clientX-n.left,i=t.clientY-n.top,a=this._active,s=this.pick(this._model.scene(),r,i,r-e.left,i-e.top);return s===a?void this.fire("mousemove",t):(a&&this.fire("mouseout",t),this._active=s,void(s&&this.fire("mouseover",t)))},r.mouseout=function(t){this._active&&this.fire("mouseout",t),this._active=null},r.mousedown=function(t){this._down=this._active,
this.fire("mousedown",t)},r.click=function(t){this._down===this._active&&(this.fire("click",t),this._down=null)},r.DOMMouseScroll=function(t){this.fire("mousewheel",t)},r.fire=function(t,e){var n=this._active,r=this._handlers[t];if(n&&r)for(var i=0,a=r.length;a>i;++i)r[i].handler.call(this._obj,e,n)},r.on=function(t,n){var r=e(t),i=this._handlers;return(i=i[r]||(i[r]=[])).push({type:t,handler:n}),this},r.off=function(t,n){var r=e(t),i=this._handlers[r];if(i){for(var a=i.length;--a>=0;)i[a].type===t&&(n&&i[a].handler!==n||i.splice(a,1));return this}},r.context=function(){return this._canvas.getContext("2d")},r.pick=function(t,e,n,r,i){var a=this.context(),s=t.marktype;return S.canvas.marks.pick[s].call(this,a,t,e,n,r,i)},n}(),S.svg={},S.svg.marks=function(){function e(t){return t.x||0}function n(t){return t.y||0}function r(t){return t.x+t.width||0}function i(t){return t.y+t.height||0}function a(t){return null==t.size?100:t.size}function s(t){return t.shape||"circle"}function o(t){var e,n,r,i,a,s=t.mark?t:t.length?t[0]:null;if(null!==s)for(e=0,n=I.length;n>e;++e)r=I[e],i=z[r],null==(a=s[r])?"fill"===i?this.style.setProperty(i,"none",null):this.style.removeProperty(i):(a.id&&(S.svg._cur._defs.gradient[a.id]=a,a="url("+window.location.href+"#"+a.id+")"),this.style.setProperty(i,a+"",null))}function u(t){var e=t.x||0,n=t.y||0;this.setAttribute("transform","translate("+e+","+n+")"),this.setAttribute("d",w(t))}function l(t){if(t.length){var e=t[0],n="horizontal"===e.orient?_:A;n.interpolate(e.interpolate||"linear").tension(null==e.tension?.7:e.tension),this.setAttribute("d",n(t))}}function c(t){if(t.length){var e=t[0];C.interpolate(e.interpolate||"linear").tension(null==e.tension?.7:e.tension),this.setAttribute("d",C(t))}}function h(t){var e=t.x||0,n=t.y||0;this.setAttribute("transform","translate("+e+","+n+")"),null!=t.path&&this.setAttribute("d",t.path)}function f(t){this.setAttribute("x",t.x||0),this.setAttribute("y",t.y||0),this.setAttribute("width",t.width||0),this.setAttribute("height",t.height||0)}function d(t){var e=t.x||0,n=t.y||0;this.setAttribute("x1",e),this.setAttribute("y1",n),this.setAttribute("x2",null!=t.x2?t.x2:e),this.setAttribute("y2",null!=t.y2?t.y2:n)}function p(t){var e=t.x||0,n=t.y||0;this.setAttribute("transform","translate("+e+","+n+")"),this.setAttribute("d",D(t))}function g(t){var e=t.width||t.image&&t.image.width||0,n=t.height||t.image&&t.image.height||0,r=t.x-("center"===t.align?e/2:"right"===t.align?e:0),i=t.y-("middle"===t.baseline?n/2:"bottom"===t.baseline?n:0),a=S.data.load.sanitizeUrl(t.url);a&&this.setAttributeNS("http://www.w3.org/1999/xlink","href",a),this.setAttribute("x",r),this.setAttribute("y",i),this.setAttribute("width",e),this.setAttribute("height",n)}function v(t){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+(null!=t.fontSize?t.fontSize:S.config.render.fontSize)+"px "+(t.font||S.config.render.font)}function F(t){var e=t.x||0,n=t.y||0,r=t.dx||0,i=t.dy||0,a=t.angle||0,s=t.radius||0,o=L[t.align||"left"],u="top"===t.baseline?".9em":"middle"===t.baseline?".35em":0;if(s){var l=(t.theta||0)-Math.PI/2;e+=s*Math.cos(l),n+=s*Math.sin(l)}this.setAttribute("x",e+r),this.setAttribute("y",n+i),this.setAttribute("text-anchor",o),a?this.setAttribute("transform","rotate("+a+" "+e+","+n+")"):this.removeAttribute("transform"),u?this.setAttribute("dy",u):this.removeAttribute("dy"),this.textContent=t.text,this.style.setProperty("font",v(t),null)}function m(t){var e=t.x||0,n=t.y||0;if(this.setAttribute("transform","translate("+e+","+n+")"),t.clip){var r={width:t.width||0,height:t.height||0},i=t.clip_id||(t.clip_id="clip"+M++);S.svg._cur._defs.clipping[i]=r,this.setAttribute("clip-path","url(#"+i+")")}}function y(t){var e=t.width||0,n=t.height||0;this.setAttribute("width",e),this.setAttribute("height",n)}function x(t){var e="type-"+t.type;return t.name&&(e+=" "+t.name),e}function b(t,e,n){return function(r,i,a){k(r,i,a,t,e,n)}}function k(e,n,r,i,a,s){var u=s?[n.items]:n.items,l=!1===n.interactive?"none":null,c="g"!==i,h=(h=e.node().childNodes[r+1])?t.select(h):e.append("g").attr("id","g"+ ++B).attr("class",x(n.def)),f="#"+h.attr("id")+" > "+i,d=h.selectAll(f).data(u),p=d.enter().append(i);return c?(h.style("pointer-events",l),p.each(function(t){t.mark?t._svg=this:t.length&&(t[0]._svg=this)})):p.append("rect").attr("class","background").style("pointer-events",l),d.exit().remove(),d.each(a),c?d.each(o):h.selectAll(f+" > rect.background").each(y).each(o),h}function E(e,n,r){var i,a,s,o=k(e,n,r,"g",m).node().childNodes,u=o.length;for(i=0;u>i;++i){var l=o[i].__data__.items,c=o[i].__data__.legendItems||[],h=o[i].__data__.axisItems||[],f=t.select(o[i]),d=0;for(a=0,s=h.length;s>a;++a)"back"===h[a].def.layer&&E.call(this,f,h[a],d++);for(a=0,s=l.length;s>a;++a)this.draw(f,l[a],d++);for(a=0,s=h.length;s>a;++a)"back"!==h[a].def.layer&&E.call(this,f,h[a],d++);for(a=0,s=c.length;s>a;++a)E.call(this,f,c[a],d++)}}var w=t.svg.arc(),A=t.svg.area().x(e).y1(n).y0(i),_=t.svg.area().y(n).x0(r).x1(e),C=t.svg.line().x(e).y(n),D=t.svg.symbol().type(s).size(a),B=0,M=0,L={left:"start",center:"middle",right:"end"},z={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeWidth:"stroke-width",strokeOpacity:"stroke-opacity",strokeCap:"stroke-linecap",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",opacity:"opacity"},I=S.keys(z);return{update:{group:f,area:l,line:c,arc:u,path:h,symbol:p,rect:f,rule:d,text:F,image:g},nested:{area:!0,line:!0},style:o,draw:{group:E,area:b("path",l,!0),line:b("path",c,!0),arc:b("path",u),path:b("path",h),symbol:b("path",p),rect:b("rect",f),rule:b("line",d),text:b("text",F),image:b("image",g),draw:b}}}(),S.svg.Renderer=function(){var e=function(){this._svg=null,this._ctx=null,this._el=null,this._defs={gradient:{},clipping:{}}},n=e.prototype;return n.initialize=function(e,n,r,i,a){return this._el=e,t.select(e).select("svg.marks").remove(),this._svg=t.select(e).append("svg").attr("class","marks"),null!=a&&this._svg.style("background-color",a),this._ctx=this._svg.append("g"),this.resize(n,r,i)},n.resize=function(t,e,n){return this._width=t,this._height=e,this._padding=n,this._svg.attr("width",t+n.left+n.right).attr("height",e+n.top+n.bottom),this._ctx.attr("transform","translate("+n.left+","+n.top+")"),this},n.context=function(){return this._ctx},n.element=function(){return this._el},n.updateDefs=function(){var e,n,r=this._svg,i=this._defs,a=S.keys(i.gradient),s=S.keys(i.clipping),o=r.select("defs");return 0===a.length&&0==s.length?void o.remove():(o.empty()&&(o=r.insert("defs",":first-child")),(e=o.selectAll("linearGradient").data(a,S.identity)).enter().append("linearGradient").attr("id",S.identity),e.exit().remove(),e.each(function(e){var n=i.gradient[e],r=t.select(this);r.attr({x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2}),stop=r.selectAll("stop").data(n.stops),stop.enter().append("stop"),stop.exit().remove(),stop.attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color})}),(n=o.selectAll("clipPath").data(s,S.identity)).enter().append("clipPath").attr("id",S.identity),n.exit().remove(),void n.each(function(e){var n=i.clipping[e],r=t.select(this).selectAll("rect").data([1]);r.enter().append("rect"),r.attr("x",0).attr("y",0).attr("width",n.width).attr("height",n.height)}))},n.render=function(t,e){S.svg._cur=this,e?this.renderItems(S.array(e)):this.draw(this._ctx,t,-1),this.updateDefs(),delete S.svg._cur},n.renderItems=function(t){var e,n,r,i,a,s=S.svg.marks;for(i=0,a=t.length;a>i;++i)n=(e=t[i])._svg,r=e.mark.marktype,e=s.nested[r]?e.mark.items:e,s.update[r].call(n,e),s.style.call(n,e)},n.draw=function(t,e,n){var r=e.marktype;S.svg.marks.draw[r].call(this,t,e,n)},e}(),S.svg.Handler=function(){function e(t){var e=this;return function(n){var r=n.target.__data__;r&&(r=r.mark?r:r[0],t.call(e._obj,n,r))}}function n(t){var e=t.indexOf(".");return 0>e?t:t.slice(0,e)}var r=function(t,e){this._active=null,this._handlers={},t&&this.initialize(t),e&&this.model(e)},i=r.prototype;return i.initialize=function(e,n,r){return this._el=t.select(e).node(),this._svg=t.select(e).select("svg.marks").node(),this._padding=n,this._obj=r||null,this},i.padding=function(t){return this._padding=t,this},i.model=function(t){return arguments.length?(this._model=t,this):this._model},i.handlers=function(){var t=this._handlers;return S.keys(t).reduce(function(e,n){return t[n].reduce(function(t,e){return t.push(e),t},e)},[])},i.on=function(r,i){var a=n(r),s=this._handlers,o=t.select(this._svg).node(),u={type:r,handler:i,svg:e.call(this,i)};return(s=s[a]||(s[a]=[])).push(u),o.addEventListener(a,u.svg),this},i.off=function(e,r){var i=n(e),a=this._handlers[i],s=t.select(this._svg).node();if(a){for(var o=a.length;--o>=0;)a[o].type===e&&(r&&a[o].handler!==r||(s.removeEventListener(i,a[o].svg),a.splice(o,1)));return this}},r}(),S.data={},S.data.ingestAll=function(t){return S.isTree(t)?u(S.data.ingestTree(t[0],t.children)):t.map(S.data.ingest)},S.data.ingest=function(t,e){return{data:t,index:e}},S.data.ingestTree=function(t,e,n){var r,i,a=S.data.ingest(t,n||0),s=t[e];if(s&&(r=s.length))for(a.values=Array(r),i=0;r>i;++i)a.values[i]=S.data.ingestTree(s[i],e,i);return a},S.data.mapper=function(t){return function(e){return e.forEach(t),e}},S.data.size=function(t,e){return(t=S.isArray(t)?t:[0,t]).map(function(t){return"string"==typeof t?e[t]:t})},S.data.load=function(){function e(t){if(S.config.baseURL&&!s.test(t)&&(S.startsWith(t,"/")||"/"===S.config.baseURL[S.config.baseURL.length-1]||(t="/"+t),t=S.config.baseURL+t),S.config.isNode&&S.startsWith(t,"//")&&(t=S.config.defaultProtocol+t),S.config.domainWhiteList){var e,n;if(S.config.isNode){var r=require("url").parse(t);if(S.config.safeMode&&"http:"!==r.protocol&&"https:"!==r.protocol)return!1;e=r.hostname,n=null}else{var i=document.createElement("a");i.href=t,""==i.host&&(i.href=i.href),e=i.hostname.toLowerCase(),n=window.location.hostname}if(n!==e)S.config.domainWhiteList.some(function(t){var n=e.length-t.length;return t===e||n>1&&"."===e[n-1]&&e.lastIndexOf(t)===n})||(S.error("URL is not whitelisted: "+t),t=!1)}return t}function n(t,e){var n=S.data.load.sanitizeUrl(t);n?S.config.isNode?S.startsWith(n,o)?i(n.slice(o.length),e):a(n,e):r(n,e):e("Bad URL",null)}function r(e,n){S.log("LOAD XHR: "+e),t.xhr(e,function(t,e){e&&(e=e.responseText),n(t,e)})}function i(t,e){S.log("LOAD FILE: "+t),require("fs").readFile(t,e)}function a(t,e){S.log("LOAD HTTP: "+t),require("request")(t,function(t,n,r){t||200!==n.statusCode?e(t,null):e(null,r)})}var s=/^([A-Za-z]+:)?\/\//,o="file://";return n.sanitizeUrl=e,n}(),S.data.read=function(){function n(t,e){var n=e&&e.type||"json";return t=a[n](t,e),e&&e.parse&&r(t,e.parse),t}function r(t,e){var n=S.keys(e),r=n.map(function(t){return s[e[t]]}),a=S.isTree(t);i(a?[t]:t,n,r,a)}function i(t,e,n,i){var a,s,o,u,l;for(s=0,u=t.length;u>s;++s){for(a=t[s],o=0,l=e.length;l>o;++o)a[e[o]]=n[o](a[e[o]]);i&&a.values&&r(a,e,n,!0)}}var a={},s={number:S.number,boolean:S.boolean,date:Date.parse};return a.json=function(t,e){var n=S.isObject(t)?t:JSON.parse(t);return e&&e.property&&(n=S.accessor(e.property)(n)),n},a.csv=function(e){return t.csv.parse(e)},a.tsv=function(e){return t.tsv.parse(e)},a.topojson=function(t,n){if(null==e)return S.error("TopoJSON library not loaded."),[];var r=S.isObject(t)?t:JSON.parse(t),i=[];return n&&n.feature?i=(i=r.objects[n.feature])?e.feature(r,i).features:(S.error("Invalid TopoJSON object: "+n.feature),[]):n&&n.mesh?i=(i=r.objects[n.mesh])?[e.mesh(r,r.objects[n.mesh])]:(S.error("Invalid TopoJSON object: "+n.mesh),[]):S.error("Missing TopoJSON feature or mesh parameter."),i},a.treejson=function(t,e){return t=S.isObject(t)?t:JSON.parse(t),S.tree(t,e.children)},n.formats=a,n.parse=r,n}(),S.data.aggregate=function(){function t(t){this.field=t,this.ops=[],this.flags=0,this.count=0}var e=1,n=2,r=4,a=8,s=16,o=32;return t.prototype.clone=function(){var e,n,r=new t(this.field);for(e in this)n=this[e],r[e]=S.isArray(n)?n.slice():n;return r},t.prototype.init=function(t){"sum"===t?(this.flags|=e,this.sum=0):"avg"===t?(this.flags|=n,this.avg=0):"var"===t||"std"===t?(this.flags|=r|n,this.avg=0,this.dev=0):"min"===t?(this.flags|=a,this.min=1/0):"max"===t?(this.flags|=s,this.max=-1/0):"median"===t&&(this.flags|=o,this.vals=[]),this.ops.push(t)},t.prototype.update=function(t){var i,u=this,l=u.flags;u.count+=1,l&e&&(u.sum+=t),l&n&&(i=t-u.avg,u.avg+=i/u.count),l&r&&(u.dev+=i*(t-u.avg)),l&a&&(u.min=t<u.min?t:u.min),l&s&&(u.max=t>u.max?t:u.max),l&o&&u.vals.push(t)},t.prototype.value=function(t){switch(t){case"sum":return this.sum;case"avg":return this.avg;case"var":return this.dev/(this.count-1);case"std":return Math.sqrt(this.dev/(this.count-1));case"min":return this.min;case"max":return this.max;case"median":var e=this.vals,n=e.length,r=~~(n/2);return n?n%2?e[r]:.5*(e[r-1]+e[r]):0}},t.prototype.done=function(t){this.vals&&this.vals.sort(S.numcmp);for(var e=this.ops,n=0;n<e.length;++n)"count"===e[n]?t.count=this.count:t[e[n]+"_"+this.field]=this.value(e[n]);return t},function(){function e(t){var e=s.reduce(function(e,n){return e.push(n(t)),e},[]).join("|");return l[e]||(l[e]=n(t))}function n(t){var e=a.map(function(t){return t.clone()});for(e.data={},i=0;i<u.length;++i)e.data[u[i]]=s[i](t);return e}function r(t){var n,r,i,a,s;for(r=0;r<t.length;++r)for(s=e(a=t[r]),i=0;i<s.length;++i)s[i].update(o[i](a));var u=[],c=0;for(n in l){for(s=l[n],r=0;r<s.length;++r)s[r].done(s.data);u.push({index:c++,data:s.data})}return l={},u}var a,s,o,u=[],l={};return r.fields=function(e){var n={};return o=[],a=S.array(e).reduce(function(e,r){var i,a=r.field;return n[a]||(o.push(S.accessor(a)),i=0===a.indexOf("data.")?a.slice(5):a,e.push(n[a]=new t(i))),n[a].init(r.op),e},[]),r},r.groupby=function(t){return u=S.array(t),s=u.map(function(t,e){return 0===t.indexOf("data.")&&(u[e]=t.slice(5)),S.accessor(t)}),r},r}}(),S.data.array=function(){function t(t){return t.map(function(t){for(var n=[],r=0,i=e.length;i>r;++r)n.push(e[r](t));return n})}var e=[];return t.fields=function(n){return e=S.array(n).map(S.accessor),t},t},S.data.bin=function(){function t(t){var o={min:null!=r?r:1/0,max:null!=i?i:-1/0,step:null!=a?a:null,maxbins:s};(null==r||null==i)&&t.forEach(function(t){var n=e(t);null==r&&n>o.max&&(o.max=n),null==i&&n<o.min&&(o.min=n)});var u=S.bins(o);return t.forEach(function(t){var r=e(t);n(t,u.start+u.step*~~((r-u.start)/u.step))}),t}var e,n,r=void 0,i=void 0,a=void 0,s=20;return t.min=function(e){return r=e,t},t.max=function(e){return i=e,t},t.step=function(e){return a=e,t},t.maxbins=function(e){return s=e,t},t.field=function(n){return n,e=S.accessor(n),t},t.output=function(e){return e,n=S.mutator(e),t},t},S.data.copy=function(){var t=S.accessor("data"),e=[],n=null,r=S.data.mapper(function(r){var i,a,s=t(r),o=n||e;for(i=0,a=e.length;a>i;++i)r[o[i]]=s[e[i]];return r});return r.from=function(e){return t=S.accessor(e),r},r.fields=function(t){return e=S.array(t),r},r.as=function(t){return n=S.array(t),r},r},S.data.cross=function(){function t(t){var i,a,s,o=[],u=e||t,l=t.length;for(a=0;l>a;++a)for(s=0;l>s;++s)n&&a===s||((i={})[r.left]=t[a],i[r.right]=u[s],o.push(i));return o}var e=null,n=!1,r={left:"a",right:"b"};return t["with"]=function(n){return e=n,t},t.diagonal=function(e){return n=!e,t},t.output=function(e){return S.keys(r).forEach(function(t){void 0!==e[t]&&(r[t]=e[t])}),t},t},S.data.facet=function(){function t(t){var r,i,a,s,o,u,l,c={key:"",keys:[],values:[]},h={},f=c.values;if(0===e.length)return f.push(r={key:"",keys:[],index:0,values:n?t.slice():t}),n&&n(r.values),c;for(o=0,s=t.length;s>o;++o){for(u=0,i=[],a="";u<e.length;++u)l=e[u](t[o]),i.push(l),a+=(u>0?"|":"")+String(l);void 0===(r=h[a])&&f.push(r=h[a]={key:a,keys:i,index:f.length,values:[]}),r.values.push(t[o])}if(n)for(o=0,s=f.length;s>o;++o)n(f[o].values);return c}var e=[],n=null;return t.keys=function(n){return e=S.array(n).map(S.accessor),t},t.sort=function(e){return n=S.data.sort().by(e),t},t},S.data.filter=function(){function t(t){return e?t.filter(e):t}var e=null;return t.test=function(n){return e=S.isFunction(n)?n:S.parse.expr(n),t},t},S.data.flatten=function(){function t(t){return e(t,[])}function e(t,n){if(t.values)for(var r=0,i=t.values.length;i>r;++r)e(t.values[r],n);else n.push(t);return n}return t},S.data.fold=function(){function t(t){var i,a,s,o,u=[],l=e.length;for(a=0,o=t.length;o>a;++a)for(i=t[a],s=0;l>s;++s){var c={index:u.length,data:i.data};c[r.key]=e[s],c[r.value]=n[s](i),u.push(c)}return u}var e=[],n=[],r={key:"key",value:"value"};return t.fields=function(r){return e=S.array(r),n=e.map(S.accessor),t},t.output=function(e){return S.keys(r).forEach(function(t){void 0!==e[t]&&(r[t]=e[t])}),t},t},S.data.force=function(){function e(t,e,i){n.size(S.data.size(u,i)).nodes(t),r&&e[r]&&n.links(e[r]),n.start();for(var a=0;o>a;++a)n.tick();return n.stop(),t}var n=t.layout.force(),r=null,i=20,a=1,s=-30,o=500,u=["width","height"],l=["friction","theta","gravity","alpha"];return e.links=function(t){return r=t,e},e.size=function(t){return u=t,e},e.linkDistance=function(t){return i="number"==typeof t?t:S.accessor(t),n.linkDistance(i),e},e.linkStrength=function(t){return a="number"==typeof t?t:S.accessor(t),n.linkStrength(a),e},e.charge=function(t){return s="number"==typeof t?t:S.accessor(t),n.charge(s),e},e.iterations=function(t){return o=t,e},l.forEach(function(t){e[t]=function(r){return n[t](r),e}}),e},S.data.force.dependencies=["links"],S.data.formula=function(){var t,e=null,n=S.identity,r=S.data.mapper(function(r,i,a){return e&&t(r,n.call(null,r,i,a)),r});return r.field=function(n){return e=n,t=S.mutator(e),r},r.expr=function(t){return n=S.isFunction(t)?t:S.parse.expr(t),r},r},S.data.geo=function(){function e(){var e={},r="mercator",i=t.geo[r](),a=S.identity,s=S.identity,o={x:"x",y:"y"},u=S.data.mapper(function(t){var e=[s(t),a(t)],n=i(e);return t[o.x]=n[0],t[o.y]=n[1],t});return u.func=function(){return i},u.projection=function(n){if(r!==n)for(var a in r=n,i=t.geo[r](),e)i[a](e[a]);return u},n.forEach(function(t){u[t]=function(n){return e[t]=n,i[t](n),u}}),u.lon=function(t){return s=S.accessor(t),u},u.lat=function(t){return a=S.accessor(t),u},u.output=function(t){return S.keys(o).forEach(function(e){void 0!==t[e]&&(o[e]=t[e])}),t},u}var n=["center","scale","translate","rotate","precision","clipAngle"];return e.params=n,e}(),S.data.geopath=function(){var e=t.geo.path().projection(t.geo.mercator()),n="mercator",r=S.identity,i={},a={path:"path"},s=S.data.mapper(function(t){return t[a.path]=e(r(t)),t});return s.projection=function(r){if(n!==r){n=r;var a=t.geo[n]();for(var o in i)a[o](i[o]);e.projection(a)}return s},S.data.geo.params.forEach(function(t){s[t]=function(n){return i[t]=n,e.projection()[t](n),s}}),s.value=function(t){return r=S.accessor(t),s},s.output=function(t){return S.keys(a).forEach(function(e){void 0!==t[e]&&(a[e]=t[e])}),t},s},S.data.link=function(){function t(t){var e=s(t),n=o(t);return"M"+e.x+","+e.y+"L"+n.x+","+n.y}function e(t){var e=s(t),n=o(t),r=n.x-e.x,i=n.y-e.y,a=u*(r+i),l=u*(i-r);return"M"+e.x+","+e.y+"C"+(e.x+a)+","+(e.y+l)+" "+(n.x+l)+","+(n.y-a)+" "+n.x+","+n.y}function n(t){var e=s(t),n=o(t),r=(e.x+n.x)/2;return"M"+e.x+","+e.y+"C"+r+","+e.y+" "+r+","+n.y+" "+n.x+","+n.y}function r(t){var e=s(t),n=o(t),r=(e.y+n.y)/2;return"M"+e.x+","+e.y+"C"+e.x+","+r+" "+n.x+","+r+" "+n.x+","+n.y}function i(t){var e=c[a];return t.forEach(function(t){t[l.path]=e(t)}),t}var a="line",s=S.accessor("source"),o=S.accessor("target"),u=.2,l={path:"path"},c={line:t,curve:e,diagonal:n,diagonalX:n,diagonalY:r};return i.shape=function(t){return a=t,i},i.tension=function(t){return u=t,i},i.source=function(t){return s=S.accessor(t),i},i.target=function(t){return o=S.accessor(t),i},i.output=function(t){return S.keys(l).forEach(function(e){void 0!==t[e]&&(l[e]=t[e])}),i},i},S.data.pie=function(){function e(e){var n=e.map(function(t){return+r(t)}),u=i,l=(a-i)/t.sum(n),c=t.range(e.length);return s&&c.sort(function(t,e){return n[t]-n[e]}),c.forEach(function(t){var r;e[t].value=r=n[t],e[t][o.startAngle]=u,e[t][o.midAngle]=u+.5*r*l,e[t][o.endAngle]=u+=r*l}),e}var n=function(){return 1},r=n,i=0,a=2*Math.PI,s=!1,o={startAngle:"startAngle",endAngle:"endAngle",midAngle:"midAngle"};return e.sort=function(t){return s=t,e},e.value=function(t){return r=t?S.accessor(t):n,e},e.startAngle=function(t){return i=Math.PI*t/180,e},e.endAngle=function(t){return a=Math.PI*t/180,e},e.output=function(t){return S.keys(o).forEach(function(e){void 0!==t[e]&&(o[e]=t[e])}),e},e},S.data.slice=function(){function t(t){if(t=S.values(t),"min"===e)t=[t[S.minIndex(t,n)]];else if("max"===e)t=[t[S.maxIndex(t,n)]];else if("median"===e){var r=t.slice().sort(function(t,e){return t=n(t),(e=n(e))>t?-1:t>e?1:0});t=[t[~~(r.length/2)]]}else{var i=S.array(e);t=t.slice(i[0],i[1])}return t}var e=null,n=S.accessor("data");return t.by=function(n){return e=n,t},t.field=function(e){return n=S.accessor(e),t},t},S.data.sort=function(){function t(t){(t=S.isArray(t)?t:t.values||[]).sort(e);for(var n=0,r=t.length;r>n;++n)t[n].index=n;return t}var e=null;return t.by=function(n){return e=S.comparator(n),t},t},S.data.stack=function(){function e(t){var e=o.y0,i=o.y1,a=o.cy,s=n(t);return 0===s.length?t:(r.out(function(t,n,r){t.datum&&(t.datum[e]=n,t.datum[i]=r+n,t.datum[a]=n+r/2)})(s),t)}function n(t){var e,n,r,s,o,u,l,c,h=S.values(t),f=[],d=[];if(0===h.length)return d;for(n=0,r=h.length;r>n;++n){for(s=0,o=(e=S.values(h[n])).length;o>s;++s)f.push({x:i(e[s]),y:a(e[s]),z:n,datum:e[s]});d.push([])}for(f.sort(function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.z<e.z?-1:t.z>e.z?1:0}),c=f[0].x,n=0,s=0,u=0,r=f.length;r>u;++u){if((l=f[u]).x!==c){for(;n<d.length;)d[n++].push({x:s,y:0});c=l.x,n=0,s+=1}for(;l.z>n;)d[n++].push({x:s,y:0});l.x=s,d[n++].push(l)}for(;n<d.length;)d[n++].push({x:s,y:0});return d}var r=t.layout.stack(),i=S.accessor("index"),a=S.accessor("data"),s=["offset","order"],o={y0:"y2",y1:"y",cy:"cy"};return e.point=function(t){return i=S.accessor(t),e},e.height=function(t){return a=S.accessor(t),e},s.forEach(function(t){e[t]=function(n){return r[t](n),e}}),e.output=function(n){return t.keys(o).forEach(function(t){void 0!==n[t]&&(o[t]=n[t])}),e},e},S.data.stats=function(){function t(t){var e,s,o,u,l=1/0,c=-1/0,h=0,f=0,d=0,p=(S.isArray(t)?t:t.values||[]).map(n);for(e=0,s=p.length;s>e;++e)l>(o=p[e])&&(l=o),o>c&&(c=o),h+=o,d+=(u=o-f)*(o-(f+=u/(e+1)));d/=s-1;var g=S.isArray(t)?{}:t;if(i&&(p.sort(S.numcmp),e=p.length>>1,g[a.median]=p.length%2?p[e]:(p[e-1]+p[e])/2),g[a.count]=s,g[a.min]=l,g[a.max]=c,g[a.sum]=h,g[a.mean]=f,g[a.variance]=d,g[a.stdev]=Math.sqrt(d),r){for(p=S.isArray(t)?t:t.values,(o={})[a.count]=s,o[a.min]=l,o[a.max]=c,o[a.sum]=h,o[a.mean]=f,o[a.variance]=d,o[a.stdev]=Math.sqrt(d),i&&(o[a.median]=g[a.median]),e=0,s=p.length;s>e;++e)p[e].stats=o;S.isArray(t)&&(g=p)}return g}function e(e){return S.isArray(e)?t(e):(e.values||[]).map(t)}var n=S.accessor("data"),r=!1,i=!1,a={count:"count",min:"min",max:"max",sum:"sum",mean:"mean",variance:"variance",stdev:"stdev",median:"median"};return e.median=function(t){return i=t||!1,e},e.value=function(t){return n=S.accessor(t),e},e.assign=function(t){return r=t,e},e.output=function(t){return S.keys(a).forEach(function(e){void 0!==t[e]&&(a[e]=t[e])}),e},e},S.data.treemap=function(){function e(t,e,a){t=n.size(S.data.size(i,a)).value(r).nodes(S.isTree(t)?t:{values:t});var o=S.keys(s),u=o.length;return t.forEach(function(t){for(var e,n,r=0;u>r;++r)(e=o[r])!==s[e]&&(n=t[e],delete t[e],t[s[e]]=n)}),t}var n=t.layout.treemap().children(function(t){return t.values}),r=S.accessor("data"),i=["width","height"],a=["round","sticky","ratio","padding"],s={x:"x",y:"y",dx:"width",dy:"height"};return e.size=function(t){return i=t,e},e.value=function(t){return r=S.accessor(t),e},a.forEach(function(t){e[t]=function(r){return n[t](r),e}}),e.output=function(t){return S.keys(s).forEach(function(e){void 0!==t[e]&&(s[e]=t[e])}),e},e},S.data.truncate=function(){var t,e=S.accessor("data"),n="right",r="...",i=!0,a=100,s=S.data.mapper(function(s){var o=S.truncate(e(s),a,n,i,r);return t(s,o),s});return s.value=function(t){return e=S.accessor(t),s},s.output=function(e){return e,t=S.mutator(e),s},s.limit=function(t){return a=+t,s},s.position=function(t){return n=t,s},s.ellipsis=function(t){return r=t+"",s},s.wordbreak=function(t){return i=!!t,s},s},S.data.unique=function(){function t(t){return S.unique(t,e).map(function(t){var e={};return e[n]=t,e})}var e=null,n="field";return t.field=function(n){return e=S.accessor(n),t},t.as=function(e){return n=e,t},t},S.data.window=function(){function t(t){var r,i,a,s=[],o=(t=S.isArray(t)?t:t.values||[]).length-e;for(r=0;o>=r;r+=n){for(i=0,a=[];e>i;++i)a.push(t[r+i]);s.push({key:r,values:a})}return{values:s}}var e=2,n=1;return t.size=function(n){return e=n,t},t.step=function(e){return n=e,t},t},S.data.wordcloud=function(){function e(t,e,o){function l(e){var r,i,s,o,l,c=n.size(),h=c[0]/2,f=c[1]/2,d=S.keys(u),p=d.length;for(t.sort(function(t,e){return a(e)-a(t)}),s=0,o=e.length;o>s;++s)for(i=t[s],l=0;p>l;++l)r=d[l],i[u[r]]=e[s][r],"x"===r&&(i[u.x]+=h),"y"===r&&(i[u.y]+=f)}return n.size(S.data.size(i,o)).text(r).fontSize(a).rotate(s).words(t).on("end",l).start(),t}var n=t.layout.cloud().size([900,500]),r=S.accessor("data"),i=["width","height"],a=function(){return 14},s=function(){return 0},o=["font","fontStyle","fontWeight","padding"],u={x:"x",y:"y",size:"fontSize",font:"font",rotate:"angle"};return e.text=function(t){return r=S.accessor(t),e},e.size=function(t){return i=t,e},e.fontSize=function(t){return a=S.accessor(t),e},e.rotate=function(t){var n;return S.isObject(t)&&!Array.isArray(t)?void 0!==t.random?(n=(n=t.random)?S.array(n):[0],s=function(){return n[~~(Math.random()*n.length-1e-5)]}):void 0!==t.alternate&&(n=(n=t.alternate)?S.array(n):[0],s=function(t,e){return n[e%n.length]}):s=S.accessor(field),e},o.forEach(function(t){e[t]=function(r){return n[t](r),e}}),e.output=function(t){return S.keys(u).forEach(function(e){void 0!==t[e]&&(u[e]=t[e])}),e},e},S.data.zip=function(){function t(t,s){var o,u,l,c,h,f=s[e],d=f.length;for(a&&(h={},f.forEach(function(t){h[a(t)]=t})),l=0,c=t.length;c>l;++l)(u=t[l])[n]=h?null!=(o=h[r(u)])?o:i:f[l%d];return t}var e=null,n="zip",r=S.accessor("data"),i=void 0,a=null;return t["with"]=function(n){return e=n,t},t["default"]=function(e){return i=e,t},t.as=function(e){return n=e,t},t.key=function(e){return r=S.accessor(e),t},t.withKey=function(e){return a=S.accessor(e),t},t},S.data.zip.dependencies=["with"],S.expression={},S.expression.parse=function(t,e){return N.parse("("+t+")",e)},S.expression.code=function(t){return O(t)};var P={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"},T=function(t){function e(e,n,r,i){var a=t(n[0]);return r&&(a=r+"("+a+")",S.startsWith(r,"new ")&&(a="("+a+")")),a+"."+e+(0>i?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}var n="new Date",r="String",i="RegExp";return{isNaN:"isNaN",isFinite:"isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",now:"Date.now",datetime:"new Date",date:function(t){return e("getDate",t,n,0)},day:function(t){return e("getDay",t,n,0)},year:function(t){return e("getFullYear",t,n,0)},month:function(t){return e("getMonth",t,n,0)},hours:function(t){return e("getHours",t,n,0)},minutes:function(t){return e("getMinutes",t,n,0)},seconds:function(t){return e("getSeconds",t,n,0)},milliseconds:function(t){return e("getMilliseconds",t,n,0)},time:function(t){return e("getTime",t,n,0)},timezoneoffset:function(t){return e("getTimezoneOffset",t,n,0)},utcdate:function(t){return e("getUTCDate",t,n,0)},utcday:function(t){return e("getUTCDay",t,n,0)},utcyear:function(t){return e("getUTCFullYear",t,n,0)},utcmonth:function(t){return e("getUTCMonth",t,n,0)},utchours:function(t){return e("getUTCHours",t,n,0)},utcminutes:function(t){return e("getUTCMinutes",t,n,0)},utcseconds:function(t){return e("getUTCSeconds",t,n,0)},utcmilliseconds:function(t){return e("getUTCMilliseconds",t,n,0)},parseFloat:"parseFloat",parseInt:"parseInt",length:function(t){return e("length",t,null,-1)},upper:function(t){return e("toUpperCase",t,r,0)},lower:function(t){return e("toLowerCase",t,r,0)},slice:function(t){return e("slice",t,r)},substring:function(t){return e("substring",t,r)},test:function(t){return e("test",t,i)},"if":function(e){if(e.length<3)throw new Error("Missing arguments to if function.");if(e.length>3)throw new Error("Too many arguments to if function.");var n=e.map(t);return n[0]+"?"+n[1]+":"+n[2]}}},O=function(t){function e(t){if(t instanceof String)return t;var e=o[t.type];if(null==e)throw new Error("Unsupported type: "+t.type);return e(t)}var n=(t=t||{}).constants||P,r=(t.functions||T)(e),i=t.idWhiteList?S.toMap(t.idWhiteList):null,a=t.idBlackList?S.toMap(t.idBlackList):null,s=0,o={Literal:function(t){return t.raw},Identifier:function(t){var e=t.name;if(s>0)return e;if(n.hasOwnProperty(e))return n[e];if(i){if(i.hasOwnProperty(e))return e;throw new Error("Illegal identifier: "+e)}if(a&&a.hasOwnProperty(e))throw new Error("Illegal identifier: "+e);return e},Program:function(t){return t.body.map(e).join("\n")},MemberExpression:function(t){var n=!t.computed,r=e(t.object);n&&(s+=1);var i=e(t.property);return n&&(s-=1),r+(n?"."+i:"["+i+"]")},CallExpression:function(t){if("Identifier"!==t.callee.type)throw new Error("Illegal callee type: "+t.callee.type);var n=t.callee.name,i=t.arguments,a=r.hasOwnProperty(n)&&r[n];if(!a)throw new Error("Unrecognized function: "+n);return a instanceof Function?a(i):a+"("+i.map(e).join(",")+")"},ArrayExpression:function(t){return"["+t.elements.map(e).join(",")+"]"},BinaryExpression:function(t){return"("+e(t.left)+t.operator+e(t.right)+")"},UnaryExpression:function(t){return"("+t.operator+e(t.argument)+")"},UpdateExpression:function(t){return"("+(prefix?t.operator+e(t.argument):e(t.argument)+t.operator)+")"},ConditionalExpression:function(t){return"("+e(t.test)+"?"+e(t.consequent)+":"+e(t.alternate)+")"},LogicalExpression:function(t){return"("+e(t.left)+t.operator+e(t.right)+")"},ObjectExpression:function(t){return"{"+t.properties.map(e).join(",")+"}"},Property:function(t){s+=1;var n=e(t.key);return s-=1,n+":"+e(t.value)},ExpressionStatement:function(t){return e(t.expression)}};return e},N=function(){"use strict";function t(t,e){if(!t)throw new Error("ASSERT: "+e)}function e(t){return t>=48&&57>=t}function n(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function r(t){return"01234567".indexOf(t)>=0}function i(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function a(t){return 10===t||13===t||8232===t||8233===t}function s(t){return 36===t||95===t||t>=65&&90>=t||t>=97&&122>=t||92===t||t>=128&&wt.NonAsciiIdentifierStart.test(String.fromCharCode(t))}function o(t){return 36===t||95===t||t>=65&&90>=t||t>=97&&122>=t||t>=48&&57>=t||92===t||t>=128&&wt.NonAsciiIdentifierPart.test(String.fromCharCode(t))}function u(t){switch(t){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function l(t){switch(t){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function c(t){if(_t&&l(t))return!0;switch(t.length){case 2:return"if"===t||"in"===t||"do"===t;case 3:return"var"===t||"for"===t||"new"===t||"try"===t||"let"===t;case 4:return"this"===t||"else"===t||"case"===t||"void"===t||"with"===t||"enum"===t;case 5:return"while"===t||"break"===t||"catch"===t||"throw"===t||"const"===t||"yield"===t||"class"===t||"super"===t;case 6:return"return"===t||"typeof"===t||"delete"===t||"switch"===t||"export"===t||"import"===t;case 7:return"default"===t||"finally"===t||"extends"===t;case 8:return"function"===t||"continue"===t||"debugger"===t;case 10:return"instanceof"===t;default:return!1}}function h(){var t;for(0===Ct;St>Ct;)if(i(t=At.charCodeAt(Ct)))++Ct;else{if(!a(t))break;++Ct,13===t&&10===At.charCodeAt(Ct)&&++Ct,++Dt,Bt=Ct,!0}}function f(t){var e,r,i,a=0;for(r="u"===t?4:2,e=0;r>e;++e){if(!(St>Ct&&n(At[Ct])))return"";i=At[Ct++],a=16*a+"0123456789abcdef".indexOf(i.toLowerCase())}return String.fromCharCode(a)}function d(){var t,e,r,i;for(e=0,"}"===(t=At[Ct])&&j({},Et.UnexpectedToken,"ILLEGAL");St>Ct&&n(t=At[Ct++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase())
;return(e>1114111||"}"!==t)&&j({},Et.UnexpectedToken,"ILLEGAL"),65535>=e?String.fromCharCode(e):(r=55296+(e-65536>>10),i=56320+(e-65536&1023),String.fromCharCode(r,i))}function p(){var t,e;for(t=At.charCodeAt(Ct++),e=String.fromCharCode(t),92===t&&(117!==At.charCodeAt(Ct)&&j({},Et.UnexpectedToken,"ILLEGAL"),++Ct,(t=f("u"))&&"\\"!==t&&s(t.charCodeAt(0))||j({},Et.UnexpectedToken,"ILLEGAL"),e=t);St>Ct&&o(t=At.charCodeAt(Ct));)++Ct,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==At.charCodeAt(Ct)&&j({},Et.UnexpectedToken,"ILLEGAL"),++Ct,(t=f("u"))&&"\\"!==t&&o(t.charCodeAt(0))||j({},Et.UnexpectedToken,"ILLEGAL"),e+=t);return e}function g(){var t,e;for(t=Ct++;St>Ct;){if(92===(e=At.charCodeAt(Ct)))return Ct=t,p();if(!o(e))break;++Ct}return At.slice(t,Ct)}function v(){var t,e;return t=Ct,{type:1===(e=92===At.charCodeAt(Ct)?p():g()).length?yt.Identifier:c(e)?yt.Keyword:"null"===e?yt.NullLiteral:"true"===e||"false"===e?yt.BooleanLiteral:yt.Identifier,value:e,lineNumber:Dt,lineStart:Bt,start:t,end:Ct}}function F(){var t,e,n,r,i=Ct,a=At.charCodeAt(Ct),s=At[Ct];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Ct,zt.tokenize&&(40===a?zt.openParenToken=zt.tokens.length:123===a&&(zt.openCurlyToken=zt.tokens.length)),{type:yt.Punctuator,value:String.fromCharCode(a),lineNumber:Dt,lineStart:Bt,start:i,end:Ct};default:if(61===(t=At.charCodeAt(Ct+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Ct+=2,{type:yt.Punctuator,value:String.fromCharCode(a)+String.fromCharCode(t),lineNumber:Dt,lineStart:Bt,start:i,end:Ct};case 33:case 61:return Ct+=2,61===At.charCodeAt(Ct)&&++Ct,{type:yt.Punctuator,value:At.slice(i,Ct),lineNumber:Dt,lineStart:Bt,start:i,end:Ct}}}return">>>="===(r=At.substr(Ct,4))?(Ct+=4,{type:yt.Punctuator,value:r,lineNumber:Dt,lineStart:Bt,start:i,end:Ct}):">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?(Ct+=3,{type:yt.Punctuator,value:n,lineNumber:Dt,lineStart:Bt,start:i,end:Ct}):s===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(s)>=0||"=>"===e?(Ct+=2,{type:yt.Punctuator,value:e,lineNumber:Dt,lineStart:Bt,start:i,end:Ct}):"<>=!+-*%&|^/".indexOf(s)>=0?(++Ct,{type:yt.Punctuator,value:s,lineNumber:Dt,lineStart:Bt,start:i,end:Ct}):void j({},Et.UnexpectedToken,"ILLEGAL")}function m(t){for(var e="";St>Ct&&n(At[Ct]);)e+=At[Ct++];return 0===e.length&&j({},Et.UnexpectedToken,"ILLEGAL"),s(At.charCodeAt(Ct))&&j({},Et.UnexpectedToken,"ILLEGAL"),{type:yt.NumericLiteral,value:parseInt("0x"+e,16),lineNumber:Dt,lineStart:Bt,start:t,end:Ct}}function y(t){for(var n="0"+At[Ct++];St>Ct&&r(At[Ct]);)n+=At[Ct++];return(s(At.charCodeAt(Ct))||e(At.charCodeAt(Ct)))&&j({},Et.UnexpectedToken,"ILLEGAL"),{type:yt.NumericLiteral,value:parseInt(n,8),octal:!0,lineNumber:Dt,lineStart:Bt,start:t,end:Ct}}function x(){var n,i,a;if(t(e((a=At[Ct]).charCodeAt(0))||"."===a,"Numeric literal must start with a decimal digit or a decimal point"),i=Ct,n="","."!==a){if(n=At[Ct++],a=At[Ct],"0"===n){if("x"===a||"X"===a)return++Ct,m(i);if(r(a))return y(i);a&&e(a.charCodeAt(0))&&j({},Et.UnexpectedToken,"ILLEGAL")}for(;e(At.charCodeAt(Ct));)n+=At[Ct++];a=At[Ct]}if("."===a){for(n+=At[Ct++];e(At.charCodeAt(Ct));)n+=At[Ct++];a=At[Ct]}if("e"===a||"E"===a)if(n+=At[Ct++],("+"===(a=At[Ct])||"-"===a)&&(n+=At[Ct++]),e(At.charCodeAt(Ct)))for(;e(At.charCodeAt(Ct));)n+=At[Ct++];else j({},Et.UnexpectedToken,"ILLEGAL");return s(At.charCodeAt(Ct))&&j({},Et.UnexpectedToken,"ILLEGAL"),{type:yt.NumericLiteral,value:parseFloat(n),lineNumber:Dt,lineStart:Bt,start:i,end:Ct}}function b(){var e,n,i,s,o,u,l,c,h="",p=!1;for(l=Dt,c=Bt,t("'"===(e=At[Ct])||'"'===e,"String literal must starts with a quote"),n=Ct,++Ct;St>Ct;){if((i=At[Ct++])===e){e="";break}if("\\"===i)if((i=At[Ct++])&&a(i.charCodeAt(0)))++Dt,"\r"===i&&"\n"===At[Ct]&&++Ct,Bt=Ct;else switch(i){case"u":case"x":"{"===At[Ct]?(++Ct,h+=d()):(u=Ct,(o=f(i))?h+=o:(Ct=u,h+=i));break;case"n":h+="\n";break;case"r":h+="\r";break;case"t":h+="\t";break;case"b":h+="\b";break;case"f":h+="\f";break;case"v":h+="\x0B";break;default:r(i)?(0!==(s="01234567".indexOf(i))&&(p=!0),St>Ct&&r(At[Ct])&&(p=!0,s=8*s+"01234567".indexOf(At[Ct++]),"0123".indexOf(i)>=0&&St>Ct&&r(At[Ct])&&(s=8*s+"01234567".indexOf(At[Ct++]))),h+=String.fromCharCode(s)):h+=i}else{if(a(i.charCodeAt(0)))break;h+=i}}return""!==e&&j({},Et.UnexpectedToken,"ILLEGAL"),{type:yt.StringLiteral,value:h,octal:p,startLineNumber:l,startLineStart:c,lineNumber:Dt,lineStart:Bt,start:n,end:Ct}}function k(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(t,e){return parseInt(e,16)<=1114111?"x":void j({},Et.InvalidRegExp)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(i){j({},Et.InvalidRegExp)}try{return new RegExp(t,e)}catch(a){return null}}function E(){var e,n,r,i;for(t("/"===(e=At[Ct]),"Regular expression literal must start with a slash"),n=At[Ct++],r=!1,i=!1;St>Ct;)if(n+=e=At[Ct++],"\\"===e)a((e=At[Ct++]).charCodeAt(0))&&j({},Et.UnterminatedRegExp),n+=e;else if(a(e.charCodeAt(0)))j({},Et.UnterminatedRegExp);else if(r)"]"===e&&(r=!1);else{if("/"===e){i=!0;break}"["===e&&(r=!0)}return i||j({},Et.UnterminatedRegExp),{value:n.substr(1,n.length-2),literal:n}}function w(){var t,e,n,r;for(e="",n="";St>Ct&&o((t=At[Ct]).charCodeAt(0));)if(++Ct,"\\"===t&&St>Ct)if("u"===(t=At[Ct])){if(r=++Ct,t=f("u"))for(n+=t,e+="\\u";Ct>r;++r)e+=At[r];else Ct=r,n+="u",e+="\\u";U({},Et.UnexpectedToken,"ILLEGAL")}else e+="\\",U({},Et.UnexpectedToken,"ILLEGAL");else n+=t,e+=t;return{value:n,literal:e}}function A(){var t,e,n,r;return Mt=null,h(),t=Ct,e=E(),n=w(),r=k(e.value,n.value),zt.tokenize?{type:yt.RegularExpression,value:r,regex:{pattern:e.value,flags:n.value},lineNumber:Dt,lineStart:Bt,start:t,end:Ct}:{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:Ct}}function _(){var t,e,n,r;return h(),t=Ct,e={start:{line:Dt,column:Ct-Bt}},n=A(),e.end={line:Dt,column:Ct-Bt},zt.tokenize||(zt.tokens.length>0&&((r=zt.tokens[zt.tokens.length-1]).range[0]===t&&"Punctuator"===r.type&&("/"===r.value||"/="===r.value)&&zt.tokens.pop()),zt.tokens.push({type:"RegularExpression",value:n.literal,regex:n.regex,range:[t,Ct],loc:e})),n}function C(t){return t.type===yt.Identifier||t.type===yt.Keyword||t.type===yt.BooleanLiteral||t.type===yt.NullLiteral}function D(){var t,e;if(!(t=zt.tokens[zt.tokens.length-1]))return _();if("Punctuator"===t.type){if("]"===t.value)return F();if(")"===t.value)return!(e=zt.tokens[zt.openParenToken-1])||"Keyword"!==e.type||"if"!==e.value&&"while"!==e.value&&"for"!==e.value&&"with"!==e.value?F():_();if("}"===t.value){if(zt.tokens[zt.openCurlyToken-3]&&"Keyword"===zt.tokens[zt.openCurlyToken-3].type){if(!(e=zt.tokens[zt.openCurlyToken-4]))return F()}else{if(!zt.tokens[zt.openCurlyToken-4]||"Keyword"!==zt.tokens[zt.openCurlyToken-4].type)return F();if(!(e=zt.tokens[zt.openCurlyToken-5]))return _()}return F()}return _()}return"Keyword"===t.type&&"this"!==t.value?_():F()}function B(){var t;return h(),Ct>=St?{type:yt.EOF,lineNumber:Dt,lineStart:Bt,start:Ct,end:Ct}:s(t=At.charCodeAt(Ct))?v():40===t||41===t||59===t?F():39===t||34===t?b():46===t?e(At.charCodeAt(Ct+1))?x():F():e(t)?x():zt.tokenize&&47===t?D():F()}function S(){var t,e,n,r;return h(),t={start:{line:Dt,column:Ct-Bt}},e=B(),t.end={line:Dt,column:Ct-Bt},e.type!==yt.EOF&&(n=At.slice(e.start,e.end),r={type:xt[e.type],value:n,range:[e.start,e.end],loc:t},e.regex&&(r.regex={pattern:e.regex.pattern,flags:e.regex.flags}),zt.tokens.push(r)),e}function M(){var t;return Ct=(t=Mt).end,Dt=t.lineNumber,Bt=t.lineStart,Mt="undefined"!=typeof zt.tokens?S():B(),Ct=t.end,Dt=t.lineNumber,Bt=t.lineStart,t}function L(){var t,e,n;t=Ct,e=Dt,n=Bt,Mt="undefined"!=typeof zt.tokens?S():B(),Ct=t,Dt=e,Bt=n}function z(){this.line=Dt,this.column=Ct-Bt}function I(){this.start=new z,this.end=null}function P(t){t.type===yt.StringLiteral?this.start={line:t.startLineNumber,column:t.start-t.startLineStart}:this.start={line:t.lineNumber,column:t.start-t.lineStart},this.end=null}function T(){Ct=Mt.start,Mt.type===yt.StringLiteral?(Dt=Mt.startLineNumber,Bt=Mt.startLineStart):(Dt=Mt.lineNumber,Bt=Mt.lineStart),zt.range&&(this.range=[Ct,0]),zt.loc&&(this.loc=new I)}function O(t){zt.range&&(this.range=[t.start,0]),zt.loc&&(this.loc=new P(t))}function N(){var t,e,n,r;return t=Ct,e=Dt,n=Bt,h(),r=Dt!==e,Ct=t,Dt=e,Bt=n,r}function j(e,n){var r,i=Array.prototype.slice.call(arguments,2),a=n.replace(/%(\d)/g,function(e,n){return t(n<i.length,"Message reference must be in range"),i[n]});throw"number"==typeof e.lineNumber?((r=new Error("Line "+e.lineNumber+": "+a)).index=e.start,r.lineNumber=e.lineNumber,r.column=e.start-Bt+1):((r=new Error("Line "+Dt+": "+a)).index=Ct,r.lineNumber=Dt,r.column=Ct-Bt+1),r.description=a,r}function U(){try{j.apply(null,arguments)}catch(t){if(!zt.errors)throw t;zt.errors.push(t)}}function W(t){if(t.type===yt.EOF&&j(t,Et.UnexpectedEOS),t.type===yt.NumericLiteral&&j(t,Et.UnexpectedNumber),t.type===yt.StringLiteral&&j(t,Et.UnexpectedString),t.type===yt.Identifier&&j(t,Et.UnexpectedIdentifier),t.type===yt.Keyword){if(u(t.value))j(t,Et.UnexpectedReserved);else if(_t&&l(t.value))return void U(t,Et.StrictReservedWord);j(t,Et.UnexpectedToken,t.value)}j(t,Et.UnexpectedToken,t.value)}function R(t){var e=M();(e.type!==yt.Punctuator||e.value!==t)&&W(e)}function q(t){if(zt.errors){var e=Mt;e.type!==yt.Punctuator&&e.value!==t?U(e,Et.UnexpectedToken,e.value):M()}else R(t)}function G(t){return Mt.type===yt.Punctuator&&Mt.value===t}function V(t){return Mt.type===yt.Keyword&&Mt.value===t}function H(){var t;return 59===At.charCodeAt(Ct)||G(";")?void M():(t=Dt,h(),void(Dt===t&&(Mt.type===yt.EOF||G("}")||W(Mt))))}function X(){var t=[],e=new T;for(R("[");!G("]");)G(",")?(M(),t.push(null)):(t.push(lt()),G("]")||R(","));return M(),e.finishArrayExpression(t)}function K(){var t,e=new T;return(t=M()).type===yt.StringLiteral||t.type===yt.NumericLiteral?(_t&&t.octal&&U(t,Et.StrictOctalLiteral),e.finishLiteral(t)):e.finishIdentifier(t.value)}function Y(){var t,e,n,r,i=new T;return(t=Mt).type===yt.Identifier?(n=K(),R(":"),r=lt(),i.finishProperty("init",n,r)):t.type!==yt.EOF&&t.type!==yt.Punctuator?(e=K(),R(":"),r=lt(),i.finishProperty("init",e,r)):void W(t)}function $(){var t,e,n,r,i=[],a={},s=String,o=new T;for(R("{");!G("}");)e=(t=Y()).key.type===bt.Identifier?t.key.name:s(t.key.value),r="init"===t.kind?kt.Data:"get"===t.kind?kt.Get:kt.Set,n="$"+e,Object.prototype.hasOwnProperty.call(a,n)?(a[n]===kt.Data?_t&&r===kt.Data?U({},Et.StrictDuplicateProperty):r!==kt.Data&&U({},Et.AccessorDataProperty):r===kt.Data?U({},Et.AccessorDataProperty):a[n]&r&&U({},Et.AccessorGetSet),a[n]|=r):a[n]=r,i.push(t),G("}")||q(",");return R("}"),o.finishObjectExpression(i)}function J(){var t;return R("("),++Lt.parenthesisCount,t=ct(),R(")"),t}function Q(){var t,e,n,r;if(G("("))return J();if(G("["))return X();if(G("{"))return $();if(t=Mt.type,r=new T,t===yt.Identifier||It[Mt.value])n=r.finishIdentifier(M().value);else if(t===yt.StringLiteral||t===yt.NumericLiteral)_t&&Mt.octal&&U(Mt,Et.StrictOctalLiteral),n=r.finishLiteral(M());else{if(t===yt.Keyword)throw new Error("Disabled.");t===yt.BooleanLiteral?((e=M()).value="true"===e.value,n=r.finishLiteral(e)):t===yt.NullLiteral?((e=M()).value=null,n=r.finishLiteral(e)):G("/")||G("/=")?(n="undefined"!=typeof zt.tokens?r.finishLiteral(_()):r.finishLiteral(A()),L()):W(M())}return n}function Z(){var t=[];if(R("("),!G(")"))for(;St>Ct&&(t.push(lt()),!G(")"));)q(",");return R(")"),t}function tt(){var t,e=new T;return C(t=M())||W(t),e.finishIdentifier(t.value)}function et(){return R("."),tt()}function nt(){var t;return R("["),t=ct(),R("]"),t}function rt(){var t,e,n,r,i=Lt.allowIn;for(r=Mt,Lt.allowIn=!0,t=Q();;)if(G("."))n=et(),t=new O(r).finishMemberExpression(".",t,n);else if(G("("))e=Z(),t=new O(r).finishCallExpression(t,e);else{if(!G("["))break;n=nt(),t=new O(r).finishMemberExpression("[",t,n)}return Lt.allowIn=i,t}function it(){var t;if(t=rt(),Mt.type===yt.Punctuator&&(G("++")||G("--"))&&!N())throw new Error("Disabled.");return t}function at(){var t,e,n;if(Mt.type!==yt.Punctuator&&Mt.type!==yt.Keyword)e=it();else{if(G("++")||G("--"))throw new Error("Disabled.");if(G("+")||G("-")||G("~")||G("!"))n=Mt,t=M(),e=at(),e=new O(n).finishUnaryExpression(t.value,e);else{if(V("delete")||V("void")||V("typeof"))throw new Error("Disabled.");e=it()}}return e}function st(t,e){var n=0;if(t.type!==yt.Punctuator&&t.type!==yt.Keyword)return 0;switch(t.value){case"||":n=1;break;case"&&":n=2;break;case"|":n=3;break;case"^":n=4;break;case"&":n=5;break;case"==":case"!=":case"===":case"!==":n=6;break;case"<":case">":case"<=":case">=":case"instanceof":n=7;break;case"in":n=e?7:0;break;case"<<":case">>":case">>>":n=8;break;case"+":case"-":n=9;break;case"*":case"/":case"%":n=11}return n}function ot(){var t,e,n,r,i,a,s,o,u,l;if(t=Mt,u=at(),0===(i=st(r=Mt,Lt.allowIn)))return u;for(r.prec=i,M(),e=[t,Mt],a=[u,r,s=at()];(i=st(Mt,Lt.allowIn))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)s=a.pop(),o=a.pop().value,u=a.pop(),e.pop(),n=new O(e[e.length-1]).finishBinaryExpression(o,u,s),a.push(n);(r=M()).prec=i,a.push(r),e.push(Mt),n=at(),a.push(n)}for(n=a[l=a.length-1],e.pop();l>1;)n=new O(e.pop()).finishBinaryExpression(a[l-1].value,a[l-2],n),l-=2;return n}function ut(){var t,e,n,r,i;return i=Mt,t=ot(),G("?")&&(M(),e=Lt.allowIn,Lt.allowIn=!0,n=lt(),Lt.allowIn=e,R(":"),r=lt(),t=new O(i).finishConditionalExpression(t,n,r)),t}function lt(){return Lt.parenthesisCount,Mt,Mt,ut()}function ct(){var t;if(t=lt(),G(","))throw new Error("Disabled.");return t}function ht(t){var e=ct();return H(),t.finishExpressionStatement(e)}function ft(){var t,e,n=Mt.type;if(n===yt.EOF&&W(Mt),n===yt.Punctuator&&"{"===Mt.value)throw new Error("Disabled.");if(e=new T,n===yt.Punctuator)switch(Mt.value){case";":throw new Error("Disabled.");case"(":return ht(e)}else if(n===yt.Keyword)throw new Error("Disabled.");return t=ct(),H(),e.finishExpressionStatement(t)}function dt(){if(Mt.type===yt.Keyword)switch(Mt.value){case"const":case"let":case"function":throw new Error("Disabled.");default:return ft()}return Mt.type!==yt.EOF?ft():void 0}function pt(){for(var t,e,n,r=[];St>Ct&&(e=Mt).type===yt.StringLiteral&&(t=dt(),r.push(t),t.expression.type===bt.Literal);)"use strict"===At.slice(e.start+1,e.end-1)?(_t=!0,n&&U(n,Et.StrictOctalLiteral)):!n&&e.octal&&(n=e);for(;St>Ct&&void 0!==(t=dt());)r.push(t);return r}function gt(){var t,e;return h(),L(),e=new T,_t=!0,t=pt(),e.finishProgram(t)}function vt(){var t,e,n,r=[];for(t=0;t<zt.tokens.length;++t)n={type:(e=zt.tokens[t]).type,value:e.value},e.regex&&(n.regex={pattern:e.regex.pattern,flags:e.regex.flags}),zt.range&&(n.range=e.range),zt.loc&&(n.loc=e.loc),r.push(n);zt.tokens=r}function Ft(t,e){var n,r;n=String,"string"==typeof t||t instanceof String||(t=n(t)),Ct=0,Dt=(At=t).length>0?1:0,Bt=0,St=At.length,Mt=null,Lt={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},zt={},(e=e||{}).tokens=!0,zt.tokens=[],zt.tokenize=!0,zt.openParenToken=-1,zt.openCurlyToken=-1,zt.range="boolean"==typeof e.range&&e.range,zt.loc="boolean"==typeof e.loc&&e.loc,"boolean"==typeof e.tolerant&&e.tolerant&&(zt.errors=[]);try{if(L(),Mt.type===yt.EOF)return zt.tokens;for(M();Mt.type!==yt.EOF;)try{M()}catch(i){if(zt.errors){zt.errors.push(i);break}throw i}vt(),r=zt.tokens,"undefined"!=typeof zt.errors&&(r.errors=zt.errors)}catch(a){throw a}finally{zt={}}return r}function mt(t,e){var n,r;r=String,"string"==typeof t||t instanceof String||(t=r(t)),Ct=0,Dt=(At=t).length>0?1:0,Bt=0,St=At.length,Mt=null,Lt={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},zt={},void 0!==e&&(zt.range="boolean"==typeof e.range&&e.range,zt.loc="boolean"==typeof e.loc&&e.loc,zt.loc&&null!==e.source&&void 0!==e.source&&(zt.source=r(e.source)),"boolean"==typeof e.tokens&&e.tokens&&(zt.tokens=[]),"boolean"==typeof e.tolerant&&e.tolerant&&(zt.errors=[]));try{n=gt(),"undefined"!=typeof zt.tokens&&(vt(),n.tokens=zt.tokens),"undefined"!=typeof zt.errors&&(n.errors=zt.errors)}catch(i){throw i}finally{zt={}}return n}var yt,xt,bt,kt,Et,wt,At,_t,Ct,Dt,Bt,St,Mt,Lt,zt;(xt={})[(yt={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9}).BooleanLiteral]="Boolean",xt[yt.EOF]="<end>",xt[yt.Identifier]="Identifier",xt[yt.Keyword]="Keyword",xt[yt.NullLiteral]="Null",xt[yt.NumericLiteral]="Numeric",xt[yt.Punctuator]="Punctuator",xt[yt.StringLiteral]="String",xt[yt.RegularExpression]="RegularExpression",bt={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BinaryExpression:"BinaryExpression",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ExpressionStatement:"ExpressionStatement",Identifier:"Identifier",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression"},kt={Data:1,Get:2,Set:4},Et={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},wt={NonAsciiIdentifierStart:new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),NonAsciiIdentifierPart:new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")},O.prototype=T.prototype={finish:function(){zt.range&&(this.range[1]=Ct),zt.loc&&(this.loc.end=new z,zt.source&&(this.loc.source=zt.source))},finishArrayExpression:function(t){return this.type=bt.ArrayExpression,this.elements=t,this.finish(),this},finishAssignmentExpression:function(t,e,n){return this.type=bt.AssignmentExpression,this.operator=t,this.left=e,this.right=n,this.finish(),this},finishBinaryExpression:function(t,e,n){return this.type="||"===t||"&&"===t?bt.LogicalExpression:bt.BinaryExpression,this.operator=t,this.left=e,this.right=n,this.finish(),this},finishCallExpression:function(t,e){return this.type=bt.CallExpression,this.callee=t,this.arguments=e,this.finish(),this},finishConditionalExpression:function(t,e,n){return this.type=bt.ConditionalExpression,this.test=t,this.consequent=e,this.alternate=n,this.finish(),this},finishExpressionStatement:function(t){return this.type=bt.ExpressionStatement,this.expression=t,this.finish(),this},finishIdentifier:function(t){return this.type=bt.Identifier,this.name=t,this.finish(),this},finishLiteral:function(t){return this.type=bt.Literal,this.value=t.value,this.raw=At.slice(t.start,t.end),t.regex&&(this.regex=t.regex),this.finish(),this},finishMemberExpression:function(t,e,n){return this.type=bt.MemberExpression,this.computed="["===t,this.object=e,this.property=n,this.finish(),this},finishObjectExpression:function(t){return this.type=bt.ObjectExpression,this.properties=t,this.finish(),this},finishProgram:function(t){return this.type=bt.Program,this.body=t,this.finish(),this},finishProperty:function(t,e,n){return this.type=bt.Property,this.key=e,this.value=n,this.kind=t,this.finish(),this},finishUnaryExpression:function(t,e){return this.type="++"===t||"--"===t?bt.UpdateExpression:bt.UnaryExpression,this.operator=t,this.argument=e,this.prefix=!0,this.finish(),this}};var It={"if":1,"this":1};return{tokenize:Ft,parse:mt}}();S.parse={},S.parse.axes=function(){function t(t,n,r){(t||[]).forEach(function(t,i){n[i]=n[i]||S.scene.axis(),e(t,i,n[i],r)})}function e(t,e,r,i){void 0!==t.scale&&r.scale(i[t.scale]),r.orient(t.orient||n[t.type]),r.offset(t.offset||0),r.layer(t.layer||"front"),r.grid(t.grid||!1),r.title(t.title||null),r.titleOffset(null!=t.titleOffset?t.titleOffset:S.config.axis.titleOffset),r.tickValues(t.values||null),r.tickFormat(t.format||null),r.tickSubdivide(t.subdivide||0),r.tickPadding(t.tickPadding||S.config.axis.padding);var a=[];if(void 0!==t.tickSize)for(var s=0;3>s;++s)a.push(t.tickSize);else{var o=S.config.axis.tickSize;a=[o,o,o]}null!=t.tickSizeMajor&&(a[0]=t.tickSizeMajor),null!=t.tickSizeMinor&&(a[1]=t.tickSizeMinor),null!=t.tickSizeEnd&&(a[2]=t.tickSizeEnd),a.length&&r.tickSize.apply(r,a),r.tickCount(t.ticks||S.config.axis.ticks);var u=t.properties;u&&u.ticks?(r.majorTickProperties(u.majorTicks?S.extend({},u.ticks,u.majorTicks):u.ticks),r.minorTickProperties(u.minorTicks?S.extend({},u.ticks,u.minorTicks):u.ticks)):(r.majorTickProperties(u&&u.majorTicks||{}),r.minorTickProperties(u&&u.minorTicks||{})),r.tickLabelProperties(u&&u.labels||{}),r.titleProperties(u&&u.title||{}),r.gridLineProperties(u&&u.grid||{}),r.domainProperties(u&&u.axis||{})}var n={x:"bottom",y:"left",top:"top",bottom:"bottom",left:"left",right:"right"};return t}(),S.parse.background=function(e){return null==e?null:t.rgb(e)+""},S.parse.data=function(t,e){function n(t){return function(n,r){n?S.error("LOADING FAILED: "+t.url):i.load[t.name]=S.data.read(r.toString(),t.format),0==--a&&e()}}function r(t){1!==l[t]&&(l[t]||(l[t]=1,(i.source[t]||[]).forEach(r),(i.deps[t]||[]).forEach(r),l[t]=2,u.push(t)))}var i={defs:t,load:{},flow:{},deps:{},source:{},sorted:null},a=0;(t||[]).forEach(function(t){if(t.url?(a+=1,S.data.load(t.url,n(t))):t.values?i.load[t.name]=S.data.read(t.values,t.format):t.source&&(i.source[t.source]||(i.source[t.source]=[])).push(t.name),t.transform){var e=S.parse.dataflow(t);i.flow[t.name]=e,e.dependencies.forEach(function(e){(i.deps[e]||(i.deps[e]=[])).push(t.name)})}});for(var s,o=(t||[]).map(S.accessor("name")),u=[],l={};o.length;)2!==l[s=o.pop()]&&r(s);return i.sorted=u.reverse(),0===a&&setTimeout(e,1),i},S.parse.dataflow=function(t){
var e=(t.transform||[]).map(S.parse.transform),n=e.length?function(t,n,r){return e.reduce(function(t,e){return e(t,n,r)},t)}:S.identity;return n.transforms=e,n.dependencies=S.keys((t.transform||[]).reduce(function(t,e){var n=S.data[e.type].dependencies;return n&&n.forEach(function(n){e[n]&&(t[e[n]]=1)}),t},{})),n},S.parse.expr=function(){var t=S.expression.parse,e=S.expression.code({idWhiteList:["d","index","data"]});return function(n){var r=e(t(n));return Function("d","index","data",'"use strict"; return ('+r+");")}}(),S.parse.legends=function(){function t(t,n,r){(t||[]).forEach(function(t,i){n[i]=n[i]||S.scene.legend(),e(t,i,n[i],r)})}function e(t,e,n,r){n.size(t.size?r[t.size]:null),n.shape(t.shape?r[t.shape]:null),n.fill(t.fill?r[t.fill]:null),n.stroke(t.stroke?r[t.stroke]:null),t.orient&&n.orient(t.orient),null!=t.offset&&n.offset(t.offset),n.title(t.title||null),n.values(t.values||null),n.format(void 0!==t.format?t.format:null);var i=t.properties;n.titleProperties(i&&i.title||{}),n.labelProperties(i&&i.labels||{}),n.legendProperties(i&&i.legend||{}),n.symbolProperties(i&&i.symbols||{}),n.gradientProperties(i&&i.gradient||{})}return t}(),S.parse.mark=function(t){var e=t.properties,n=t.marks;if(S.keys(e).forEach(function(n){e[n]=S.parse.properties(t.type,e[n])}),t.delay&&(t.delay=S.parse.properties(t.type,{delay:t.delay})),t.from){var r=t.from.data,i=S.parse.dataflow(t.from);t.from=function(t,e,n){var a=S.scene.data(r?t[r]:null,n);return i(a,t,e)}}return n&&(t.marks=n.map(S.parse.mark)),t},S.parse.marks=function(t,e,n){return{type:"group",width:e,height:n,scales:t.scales||[],axes:t.axes||[],legends:t.legends||[],marks:(t.marks||[]).map(S.parse.mark)}},S.parse.padding=function(t){if(null==t)return"auto";if(S.isString(t))return"strict"===t?"strict":"auto";if(S.isObject(t))return t;var e=S.isNumber(t)?t:20;return{top:e,left:e,right:e,bottom:e}},S.parse.properties=function(){function t(t,r){var i,a,s,o,u="",l=S.keys(r),c={};for(u+="var o = trans ? {} : item;\n",i=0,a=l.length;a>i;++i)o=r[s=l[i]],u+=i>0?"\n  ":"  ",u+="o."+s+" = "+n(s,o)+";",c[s]=!0;c.x2&&(c.x?(u+="\n  if (o.x > o.x2) { var t = o.x; o.x = o.x2; o.x2 = t; };",u+="\n  o.width = (o.x2 - o.x);"):u+=c.width?"\n  o.x = (o.x2 - o.width);":"\n  o.x = o.x2;"),c.xc&&(u+=c.width?"\n  o.x = (o.xc - o.width/2);":"\n  o.x = o.xc;"),c.y2&&(c.y?(u+="\n  if (o.y > o.y2) { var t = o.y; o.y = o.y2; o.y2 = t; };",u+="\n  o.height = (o.y2 - o.y);"):u+=c.height?"\n  o.y = (o.y2 - o.height);":"\n  o.y = o.y2;"),c.yc&&(u+=c.height?"\n  o.y = (o.yc - o.height/2);":"\n  o.y = o.yc;"),e(t,c)&&(u+="\n  item.touch();"),u+="\n  if (trans) trans.interpolate(item, o);";try{return Function("item","group","trans",u)}catch(h){S.error(h),S.log(u)}}function e(t,e){return e.path||("area"===t||"line"===t)&&(e.x||e.x2||e.width||e.y||e.y2||e.height||e.tension||e.interpolate)}function n(t,e){if(null==e)return null;if("fill"===t||"stroke"===t){if(e.c)return r("hcl",e.h,e.c,e.l);if(e.h||e.s)return r("hsl",e.h,e.s,e.l);if(e.l||e.a)return r("lab",e.l,e.a,e.b);if(e.r||e.g||e.b)return r("rgb",e.r,e.g,e.b)}if(e.template)return S.parse.template.source(e.template,"item.datum");var n="item.datum.data";if(void 0!==e.value&&(n=S.str(e.value)),null!=e.group){var a="group.datum";S.isString(e.group)&&(a=i[e.group]?"group."+e.group:"group.datum["+S.field(e.group).map(S.str).join("][")+"]")}if(null!=e.field?S.isString(e.field)?(n="item.datum["+S.field(e.field).map(S.str).join("][")+"]",null!=e.group&&(n="this.accessor("+n+")("+a+")")):n="this.accessor(group.datum["+S.field(e.field.group).map(S.str).join("][")+"])(item.datum.data)":null!=e.group&&(n=a),null!=e.scale){var s=S.isString(e.scale)?S.str(e.scale):(e.scale.group?"group":"item")+".datum["+S.str(e.scale.group||e.scale.field)+"]";n=(s="group.scales["+s+"]")+(e.band?".rangeBand()":"("+n+")")}return"("+(null!=e.mult?S.number(e.mult)+" * ":"")+n+")"+(e.offset?" + "+S.number(e.offset):"")}function r(t,e,r,i){return"(this.d3."+t+"("+[e?n("",e):S.config.color[t][0],r?n("",r):S.config.color[t][1],i?n("",i):S.config.color[t][2]].join(",")+') + "")'}var i={width:1,height:1,"mark.group.width":1,"mark.group.height":1};return t}(),S.parse.scales=function(){function e(t,e,r,i){return(t||[]).reduce(function(t,e){var a=e.name,s=a+":prev";return t[a]=n(e,t[a],r,i),t[s]=t[s]||t[a],t},e||{})}function n(t,e,n,s){if(e)return e;var o=r(t,e);return(o.type===h?i:a)(t,o,l(t,s),n,S.values(s.datum)),o}function r(e,n){var r=e.type||c;if(!n||r!==n.type){var i=S.config.scale[r]||t.scale[r];i||S.error("Unrecognized scale type: "+r),(n=i()).type=n.type||r,n.scaleName=e.name}return n}function i(t,e,n,r,i){var a,u=!1,l=t.padding||0,c=null==t.outerPadding?l:t.outerPadding;if(S.isObject(t.range)&&!S.isArray(t.range)&&(u=!0,n=s(t.range.fields||S.array(t.range),r,i)),(a=o(t,r,i,t.sort&&!u))&&e.domain(a),t.bandWidth){var h=t.bandWidth,f=a.length,d=n[0]||0;n=[d,d+(h*f+(t.points?l*h:l*h*(f-1)+2*c))]}"string"==typeof n[0]||n.length>2||1===n.length||u?e.range(n):t.points&&(t.round||null==t.round)?e.rangeRoundPoints(n,l):t.points?e.rangePoints(n,l):t.round||null==t.round?e.rangeRoundBands(n,l,c):e.rangeBands(n,l,c)}function a(e,n,r,i,a){var s,l;s=e.type===g?o(e,i,a,!1):u(e,i,a),n.domain(s),"height"===e.range&&(r=r.reverse()),n[e.round&&n.rangeRound?"rangeRound":"range"](r),e.exponent&&e.type===d&&n.exponent(e.exponent),e.clamp&&n.clamp(!0),e.nice&&(e.type===p?((l=t.time[e.nice])||S.error("Unrecognized interval: "+l),n.nice(l)):n.nice())}function s(t,e,n){return t.reduce(function(t,r){var i=S.values(e[r.data]||n),a=S.accessor(S.isString(r.field)?r.field:"data."+S.accessor(r.field.group)(n));return S.unique(i,a,t)},[])}function o(t,e,n,r){var i,a=t.domain;return S.isArray(a)?i=r?a.slice():a:S.isObject(a)&&(i=s(a.fields||S.array(a),e,n)),i&&r&&i.sort(S.cmp),i}function u(e,n,r){function i(e,i,a,o){var u=S.values(n[e.data]||r);S.array(e.field).map(function(t){return S.isString(t)?t:"data."+S.accessor(t.group)(r)}).forEach(function(e){e=S.accessor(e),i&&(s[0]=t.min([s[0],t.min(u,e)])),a&&(s[o]=t.max([s[o],t.max(u,e)]))})}var a,s=[null,null];return void 0!==e.domain&&(S.isArray(e.domain)?s=e.domain.slice():S.isObject(e.domain)?(e.domain.fields||S.array(e.domain)).forEach(function(t){i(t,1,1,1)}):s=e.domain),a=s.length-1,void 0!==e.domainMin&&(S.isObject(e.domainMin)?(s[0]=null,(e.domainMin.fields||S.array(e.domainMin)).forEach(function(t){i(t,1,0,a)})):s[0]=e.domainMin),void 0!==e.domainMax&&(S.isObject(e.domainMax)?(s[a]=null,(e.domainMax.fields||S.array(e.domainMax)).forEach(function(t){i(t,0,1,a)})):s[a]=e.domainMax),e.type===f||e.type===p||!e.zero&&void 0!==e.zero||(s[0]=Math.min(0,s[0]),s[a]=Math.max(0,s[a])),s}function l(t,e){var n=[null,null];if(void 0!==t.range)if("string"==typeof t.range)if(v[t.range])n=[0,e[t.range]];else{if(!S.config.range[t.range])return S.error("Unrecogized range: "+t.range),n;n=S.config.range[t.range]}else if(S.isArray(t.range))n=S.duplicate(t.range);else{if(S.isObject(t.range))return null;n=[0,t.range]}if(void 0!==t.rangeMin&&(n[0]=t.rangeMin),void 0!==t.rangeMax&&(n[n.length-1]=t.rangeMax),void 0!==t.reverse){var r=t.reverse;S.isObject(r)&&(r=S.accessor(r.field)(e.datum)),r&&(n=n.reverse())}return n}var c="linear",h="ordinal",f="log",d="pow",p="time",g="quantile",v={width:1,height:1};return e}(),S.parse.spec=function(e,n,r){function i(t){var e=(t=S.duplicate(t)).width||500,i=t.height||500,a={width:e,height:i,viewport:t.viewport||null,background:S.parse.background(t.background),padding:S.parse.padding(t.padding),marks:S.parse.marks(t,e,i),data:S.parse.data(t.data,function(){n(s)})},s=r(a)}r=r||S.ViewFactory,S.isObject(e)?i(e):t.json(e,function(t,e){t?S.error(t):i(e)})},S.parse.template=function(t){var e=S.parse.template.source(t,"d");e="var __t; return "+e+";";try{return new Function("d",e).bind(S)}catch(n){throw n.source=e,n}},S.parse.template.source=function(t,e){e=e||"obj";var n=0,r="'",i=U;return t.replace(i,function(i,a,s){return r+=t.slice(n,s).replace(R,q),n=s+i.length,a&&(r+="'\n+((__t=("+j(a,e)+"))==null?'':__t)+\n'"),i}),r+"'"};var j=function(e,n){function r(t){return t=t||"",s?(s=!1,o="String("+o+")"+t):o+=t,o}var i=e.split("|"),a=i.shift().trim(),s=!0,o=S.field(a).map(S.str).join("][");o=n+"["+o+"]";for(var u=0;u<i.length;++u){var l,c,h,f=i[u],d=null;switch((l=f.indexOf(":"))>0&&(f=f.slice(0,l),d=i[u].slice(l+1).split(",").map(function(t){return t.trim()})),f=f.trim()){case"length":r(".length");break;case"lower":r(".toLowerCase()");break;case"upper":r(".toUpperCase()");break;case"lower-locale":r(".toLocaleLowerCase()");break;case"upper-locale":r(".toLocaleUpperCase()");break;case"trim":r(".trim()");break;case"left":r(".slice(0,"+(c=S.number(d[0]))+")");break;case"right":r(".slice(-"+(c=S.number(d[0]))+")");break;case"mid":r(".slice(+"+(c=S.number(d[0]))+","+(h=c+S.number(d[1]))+")");break;case"slice":r(".slice("+(c=S.number(d[0]))+(d.length>1?","+S.number(d[1]):"")+")");break;case"truncate":c=S.number(d[0]),h="left"!==(h=d[1])&&"middle"!==h&&"center"!==h?"right":h,o="this.truncate("+r()+","+c+',"'+h+'")';break;case"number":c=H(d[0],t.format),s=!1,o="this.__formats["+c+"]("+o+")";break;case"time":c=H(d[0],t.time.format),s=!1,o="this.__formats["+c+"]("+o+")";break;default:throw Error("Unrecognized template filter: "+f)}}return o},U=/\{\{(.+?)\}\}|$/g,W={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\u2028|\u2029/g,q=function(t){return"\\"+W[t]},G=[],V={},H=function(t,e){if(!("'"===t[0]&&"'"===t[t.length-1]||'"'!==t[0]&&'"'===t[t.length-1]))throw Error("Format pattern must be quoted: "+t);if(t=t.slice(1,-1),!V[t]){var n=e(t),r=G.length;G.push(n),V[t]=r}return V[t]};S.__formats=G,S.parse.transform=function(t){var e=S.data[t.type]();return S.keys(t).forEach(function(n){"type"!==n&&e[n](t[n])}),e},S.scene={},S.scene.GROUP="group",S.scene.ENTER=0,S.scene.UPDATE=1,S.scene.EXIT=2,S.scene.DEFAULT_DATA={sentinel:1},S.scene.data=function(t,e){var n=S.scene.DEFAULT_DATA;return(t=S.values(t||e||[n]))===n&&(t=[n]),t},S.scene.fontString=function(t){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+(null!=t.fontSize?t.fontSize:S.config.render.fontSize)+"px "+(t.font||S.config.render.font)},S.scene.Item=function(){function t(t){this.mark=t}var e=t.prototype;return e.hasPropertySet=function(t){var e=this.mark.def.properties;return e&&null!=e[t]},e.cousin=function(t,e){if(0===t)return this;t=t||-1;var n=this.mark,r=n.group,i=null==e?n.items.indexOf(this):e,a=r.items.indexOf(n)+t;return r.items[a].items[i]},e.sibling=function(t){if(0===t)return this;t=t||-1;var e=this.mark,n=e.items.indexOf(this)+t;return e.items[n]},e.remove=function(){var t=this,e=t.mark.items,n=e.indexOf(t);return n>=0&&(n===e.length-1?e.pop():e.splice(n,1)),t},e.touch=function(){this.pathCache&&(this.pathCache=null),this.mark.pathCache&&(this.mark.pathCache=null)},t}(),S.scene.item=function(t){return new S.scene.Item(t)},S.scene.visit=function(t,e){var n,r,i,a,s;if(e(t))return!0;var o=["items","axisItems","legendItems"];for(i=0,a=o.length;a>i;++i)if(s=t[o[i]])for(n=0,r=s.length;r>n;++n)if(S.scene.visit(s[n],e))return!0},S.scene.build=function(){function e(t,e,s,u,l){var c=S.scene.data(t.from?t.from(e,s,u):null,u);return(s=n(t,s)).items=r(t,c,s),a(t,s),t.type===o&&i(t,e,s,l),s}function n(t,e){return(e=e||{}).def=t,e.marktype=t.type,e.interactive=!(!1===t.interactive),e}function r(t,e,n){var r,i,a,o,h,f,d=s(t.key),p=n.items||[],g=[],v={};for(r=0,a=p.length;a>r;++r)(o=p[r]).status=c,d&&(v[o.key]=o);for(r=0,a=e.length;a>r;++r)h=e[r],i=r,f=!(o=d?v[i=d(h)]:p[r])&&(o=S.scene.item(n),!0),o.status=f?u:l,o.datum=h,o.key=i,g.push(o);for(r=0,a=p.length;a>r;++r)(o=p[r]).status===c&&(o.key=d?o.key:g.length,g.splice(o.index,0,o));return g}function i(t,n,r,i){var a,s,o,u,l,c,h=r.items,f=t.marks;for(a=0,s=h.length;s>a;++a){if(c=h[a],!i&&c.scales)for(l in c.scales)l.indexOf(":prev")<0&&(c.scales[l+":prev"]=c.scales[l].copy());for(c.items=c.items||[],o=0,u=f.length;u>o;++o)c.items[o]=e(f[o],n,c.items[o],c.datum),c.items[o].group=c}}function a(e,n){if(e.duration&&(n.duration=e.duration),e.ease&&(n.ease=t.ease(e.ease)),e.delay){var r,i=n.items,a=n.group,s=i.length;for(r=0;s>r;++r)e.delay.call(this,i[r],a)}}function s(t){if(null==t)return null;var e=S.array(t).map(S.accessor);return function(t){for(var n="",r=0,i=e.length;i>r;++r)r>0&&(n+="|"),n+=String(e[r](t));return n}}var o=S.scene.GROUP,u=S.scene.ENTER,l=S.scene.UPDATE,c=S.scene.EXIT;return e}(),S.scene.bounds=function(){function e(){return k||(k=(S.config.isNode?new(require("canvas"))(1,1):t.select("body").append("canvas").attr("class","vega_hidden").attr("width",1).attr("height",1).style("display","none").node()).getContext("2d"))}function n(t,e,n){return null==e?n.set(0,0,0,0):(v(e,n),t.stroke&&0!==t.opacity&&t.strokeWidth>0&&n.expand(t.strokeWidth)),n}function r(t,e){var r=t.path?t.pathCache||(t.pathCache=g(t.path)):null;return n(t,r,e)}function i(t,e){var r=t.mark.items,i=(t=r[0]).pathCache||(t.pathCache=g(F(r)));return n(r[0],i,e)}function a(t,e){var r=t.mark.items,i=(t=r[0]).pathCache||(t.pathCache=g(m(r)));return n(r[0],i,e)}function s(t,e){var n=t.x||0,r=t.y||0,i=n+t.width||0,a=r+t.height||0;return e.set(n,r,i,a),t.stroke&&0!==t.opacity&&t.strokeWidth>0&&e.expand(t.strokeWidth),e}function o(t,e){var n=t.width||0,r=t.height||0,i=(t.x||0)-("center"===t.align?n/2:"right"===t.align?n:0),a=(t.y||0)-("middle"===t.baseline?r/2:"bottom"===t.baseline?r:0);return e.set(i,a,i+n,a+r)}function u(t,e){var n,r;return e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t.stroke&&0!==t.opacity&&t.strokeWidth>0&&e.expand(t.strokeWidth),e}function l(t,e){var n,r,i,a,s,o,u,l,c,h=t.x||0,f=t.y||0,d=t.innerRadius||0,p=t.outerRadius||0,g=(t.startAngle||0)-y,v=(t.endAngle||0)-y,F=1/0,m=-1/0,x=1/0,b=-1/0,k=[g,v],E=g-g%y;for(r=0;4>r&&v>E;++r,E+=y)k.push(E);for(r=0,i=k.length;i>r;++r)n=k[r],o=d*(a=Math.cos(n)),l=p*a,u=d*(s=Math.sin(n)),c=p*s,F=Math.min(F,o,l),m=Math.max(m,o,l),x=Math.min(x,u,c),b=Math.max(b,u,c);return e.set(h+F,f+x,h+m,f+b),t.stroke&&0!==t.opacity&&t.strokeWidth>0&&e.expand(t.strokeWidth),e}function c(t,e){var n,r,i,a,s=null!=t.size?t.size:100,o=t.x||0,u=t.y||0;switch(t.shape){case"cross":r=3*(n=Math.sqrt(s/5)/2),e.set(o-r,u-n,o+r,u+n);break;case"diamond":i=(a=Math.sqrt(s/(2*b)))*b,e.set(o-i,u-a,o+i,u+a);break;case"square":n=(r=Math.sqrt(s))/2,e.set(o-n,u-n,o+n,u+n);break;case"triangle-down":case"triangle-up":a=(i=Math.sqrt(s/x))*x/2,e.set(o-i,u-a,o+i,u+a);break;default:n=Math.sqrt(s/Math.PI),e.set(o-n,u-n,o+n,u+n)}return t.stroke&&0!==t.opacity&&t.strokeWidth>0&&e.expand(t.strokeWidth),e}function h(t,n,r){var i,a,s=(t.x||0)+(t.dx||0),o=(t.y||0)+(t.dy||0),u=t.fontSize||S.config.render.fontSize,l=t.align,c=t.baseline,h=t.radius||0,f=e();return f.font=S.scene.fontString(t),f.textAlign=l||"left",f.textBaseline=c||"alphabetic",i=f.measureText(t.text||"").width,h&&(a=(t.theta||0)-Math.PI/2,s+=h*Math.cos(a),o+=h*Math.sin(a)),"center"===l?s-=i/2:"right"===l&&(s-=i),"top"===c?o+=u/5:"bottom"===c?o-=u:"middle"===c?o=o-u/2+u/10:o-=4*u/5,n.set(s,o,s+i,o+u),t.angle&&!r&&n.rotate(t.angle*Math.PI/180,t.x||0,t.y||0),n.expand(r?0:1)}function f(t,e,n){var r,i,a=t.axisItems||[],s=t.legendItems||[];for(r=0,i=a.length;i>r;++r)e.union(a[r].bounds);for(r=0,i=t.items.length;i>r;++r)e.union(t.items[r].bounds);if(n){for(r=0,i=s.length;i>r;++r)e.union(s[r].bounds);null!=t.width&&null!=t.height&&e.add(t.width,t.height),null!=t.x&&null!=t.y&&e.add(0,0)}return e.translate(t.x||0,t.y||0),e}function d(t,e,n){e=e||E[t.mark.marktype],t.bounds_prev||(t["bounds:prev"]=new S.Bounds);var r=t.bounds,i=t["bounds:prev"];return r&&i.clear().union(r),t.bounds=e(t,r?r.clear():new S.Bounds,n),r||i.clear().union(t.bounds),t.bounds}function p(t,e,n){e=e||t.bounds&&t.bounds.clear()||new S.Bounds;var r,i,a=t.marktype,s=E[a],o=t.items;if("area"===a||"line"===a)o.length&&(o[0].bounds=s(o[0],e));else for(r=0,i=o.length;i>r;++r)e.union(d(o[r],s,n));t.bounds=e}var g=S.canvas.path.parse,v=S.canvas.path.bounds,F=S.canvas.path.area,m=S.canvas.path.line,y=Math.PI/2,x=Math.sqrt(3),b=Math.tan(30*Math.PI/180),k=null,E={group:f,symbol:c,image:o,rect:s,rule:u,arc:l,text:h,path:r,area:i,line:a};return{mark:p,item:d,text:h,group:f}}(),S.scene.encode=function(){function t(t,r,i,a,s,o){return a&&s?e.call(this,t,r,i,a,s,o):n.call(this,t,t,r,i,a,o),t}function e(t,e,n,r,i){var a,s,o,u,l,c;for(a=0,s=(i=S.array(i)).length;s>a;++a)u=(o=i[a]).mark.group||null,(c=(l=o.mark.def.properties)&&l[r])&&(c.call(S,o,u,n),S.scene.bounds.item(o))}function n(t,e,n,r,o,u){a.call(this,t,e.items,n,r,o,u),e.marktype===s?i.call(this,e,n,t,r,o,u):S.scene.bounds.mark(e)}function r(t,e,n,r,s,o){i.call(this,e,n,t,r,s,o),a.call(this,t,e.items,n,r,s),S.scene.bounds.mark(e,null,!0)}function i(t,e,i,a,s,o){var u,l,c,h,f,d,p,g,v,F,m,y;for(u=0,l=t.items.length;l>u;++u)for(d=(f=t.items[u]).scales||(f.scales=e.scales?S.extend({},i.scales):i.scales),e.scales&&S.parse.scales(e.scales,d,this._data,f),e.axes&&(p=f.axes||(f.axes=[]),g=f.axisItems||(f.axisItems=[]),S.parse.axes(e.axes,p,f.scales),p.forEach(function(t,e){v=t.def(),g[e]=S.scene.build(v,this._data,g[e],null,1),g[e].group=f,n.call(this,f,f.axisItems[e],v,a)})),c=0,h=f.items.length;h>c;++c)n.call(this,f,f.items[c],e.marks[c],a,s);if(S.scene.bounds.mark(t,null,!e.legends),!1!==o&&e.legends){for(u=0,l=t.items.length;l>u;++u)F=(f=t.items[u]).legends||(f.legends=[]),m=f.legendItems||(f.legendItems=[]),S.parse.legends(e.legends,F,f.scales),F.forEach(function(t,e){y=t.def(),m[e]=S.scene.build(y,this._data,m[e],null,1),m[e].group=f,r.call(this,f,f.legendItems[e],y,a)});S.scene.bounds.mark(t,null,!0)}}function a(t,e,n,r,i){var a,s,h,f,d=n.properties||c,p=d.enter,g=d.update,v=d.exit;if(i){if(f=d[i])for(a=0,s=e.length;s>a;++a)f.call(S,e[a],t,r)}else for(a=0;a<e.length;++a)(h=e[a]).status===o&&(p&&p.call(S,h,t),h.status=u),h.status!==l&&g&&g.call(S,h,t,r),h.status===l&&(v&&v.call(S,h,t,r),r&&!v?r.interpolate(h,c):r||e[a--].remove())}var s=S.scene.GROUP,o=S.scene.ENTER,u=S.scene.UPDATE,l=S.scene.EXIT,c={};return t}(),S.scene.Transition=function(){function e(e,n){this.duration=e||500,this.ease=n&&t.ease(n)||t.ease("cubic-in-out"),this.updates={next:null}}function n(t){for(var e,n,r,i,a,s=this.updates,o=s.next,u=this.duration,l=!0;null!=o;o=(s=o).next)if(0>(n=(t-((e=o.item).delay||0))/u))l=!1;else{for(n>1&&(n=1),r=o.ease(n),i=0,a=o.length;a>i;++i)e[o[i].property]=o[i](r);e.touch(),S.scene.bounds.item(e),1===n?(o.remove&&e.remove(),s.next=o.next,o=s):l=!1}return this.callback(),l}var r=e.prototype,i={text:1,url:1};return r.interpolate=function(e,n){var r,a,s,o,u=null;for(r in n)(a=e[r])!==(s=n[r])&&(i[r]||void 0===a?e[r]=s:"number"!=typeof a||isFinite(a)?((o=t.interpolate(a,s)).property=r,(u||(u=[])).push(o)):e[r]=s);return null===u&&e.status===S.scene.EXIT&&(u=[]),null!=u&&(u.item=e,u.ease=e.mark.ease||this.ease,u.next=this.updates.next,this.updates.next=u),this},r.start=function(e){for(var r=this,i=r.updates,a=i.next;null!=a;a=(i=a).next)a.item.status===S.scene.EXIT&&(a.remove=!0);r.callback=e,t.timer(function(t){return n.call(r,t)})},e}(),S.scene.transition=function(t,e){return new S.scene.Transition(t,e)},S.scene.axis=function(){function e(){c=null}function n(){return M||("log"===s.type?".1s":null)}function r(){var e=n();return s.tickFormat?s.tickFormat(z,e):e?"time"===s.type?t.time.format(e):t.format(e):String}function i(t){var e={major:B,minor:null};return null==e.major&&(e.major=s.ticks?s.ticks(z):s.domain()),e.minor=h(s,e.major,L).map(S.data.ingest),e.major=e.major.map(function(e){return(e=S.data.ingest(e)).label=t(e.data),e}),e}function a(t){var e,n,r;"ordinal"===t.type?n=e={scale:t.scaleName,offset:.5+t.rangeBand()/2}:(e={scale:t.scaleName,offset:.5},n={scale:t.scaleName+":prev",offset:.5}),r=d(t);var i=y(),a=y(),s=y(),u=x(),c=k(),h=b();return i.properties.enter.stroke={value:S.config.axis.gridColor},g(o,i,n,e,1/0),g(o,a,n,e,A),g(o,s,n,e,_),p(o,u,n,e,A,D),F(o,c,r,C),v(o,h,r,l),S.extend(i.properties.update,I),S.extend(a.properties.update,T),S.extend(s.properties.update,O),S.extend(u.properties.update,P),S.extend(c.properties.update,j),S.extend(h.properties.update,N),{type:"group",interactive:!1,properties:{enter:m,update:m},marks:[i,a,s,u,c,h].map(S.parse.mark)}}var s,o=S.config.axis.orient,u=0,l=S.config.axis.titleOffset,c=null,f="front",E=!1,w=null,A=S.config.axis.tickSize,_=S.config.axis.tickSize,C=S.config.axis.tickSize,D=S.config.axis.padding,B=null,M=null,L=0,z=S.config.axis.ticks,I={},P={},T={},O={},N={},j={},U={def:function(){var t=c||(c=a(s)),e=i(r()),n=w?[w].map(S.data.ingest):[];return t.marks[0].from=function(){return E?e.major:[]},t.marks[1].from=function(){return e.major},t.marks[2].from=function(){return e.minor},t.marks[3].from=t.marks[1].from,t.marks[4].from=function(){return[1]},t.marks[5].from=function(){return n},t.offset=u,t.orient=o,t.layer=f,t},scale:function(t){return arguments.length?(s!==t&&(s=t,e()),U):s},orient:function(t){return arguments.length?(o!==t&&(o=t in X?t+"":S.config.axis.orient,e()),U):o},title:function(t){return arguments.length?(w!==t&&(w=t,e()),U):w},tickCount:function(t){return arguments.length?(z=t,U):z},tickValues:function(t){return arguments.length?(B=t,U):B},tickFormat:function(t){return arguments.length?(M!==t&&(M=t,e()),U):M},tickSize:function(t,n){if(!arguments.length)return A;var r=arguments.length-1,i=+t,a=r>1?+n:A,s=r>0?+arguments[r]:A;return(A!==i||_!==a||C!==s)&&e(),A=i,_=a,C=s,U},tickSubdivide:function(t){return arguments.length?(L=+t,U):L},offset:function(t){return arguments.length?(u=S.isObject(t)?t:+t,U):u},tickPadding:function(t){return arguments.length?(D!==+t&&(D=+t,e()),U):D},titleOffset:function(t){return arguments.length?(l!==+t&&(l=+t,e()),U):l},layer:function(t){return arguments.length?(f!==t&&(f=t,e()),U):f},grid:function(t){return arguments.length?(E!==t&&(E=t,e()),U):E},gridLineProperties:function(t){return arguments.length?(I!==t&&(I=t),U):I},majorTickProperties:function(t){return arguments.length?(T!==t&&(T=t),U):T},minorTickProperties:function(t){return arguments.length?(O!==t&&(O=t),U):O},tickLabelProperties:function(t){return arguments.length?(P!==t&&(P=t),U):P},titleProperties:function(t){return arguments.length?(N!==t&&(N=t),U):N},domainProperties:function(t){return arguments.length?(j!==t&&(j=t),U):j},reset:function(){e()}};return U};var X={top:1,right:1,bottom:1,left:1},K={bottom:"center",top:"center",left:"right",right:"left"},Y={bottom:"top",top:"bottom",left:"middle",right:"middle"};S.scene.legend=function(){function e(){I=null}function n(t){return"ordinal"===t||"quantize"===t||"quantile"===t||"threshold"===t}function r(e){var n,r,a,s=i(o,u,l,c),p=(null==f?e.ticks?e.ticks.apply(e,y):e.domain():f).map(S.data.ingest),v=null==d?e.tickFormat?e.tickFormat.apply(e,y):String:d,F=5,x=t.range(p.length);o?(r=p.map(function(t){return Math.sqrt(o(t.data))}),a=t.max(r),r=r.reduce(function(t,e,n,r){return n>0&&(t[n]=t[n-1]+r[n-1]/2+F),t[n]+=e/2,t},[0]).map(Math.round)):(a=Math.round(Math.sqrt(S.config.legend.symbolSize)),r=h||(n=L.fontSize)&&n.value+F||S.config.legend.labelFontSize+F,r=x.map(function(t,e){return Math.round(a/2+e*r)}));var b,k=m;g&&(k+=5+((b=M.fontSize)&&b.value||S.config.legend.titleFontSize));for(var E=0,w=r.length;w>E;++E)r[E]+=k;e={name:"legend",type:"ordinal",points:!0,domain:x,range:r};var A=(g?[g]:[]).map(S.data.ingest);return p.forEach(function(t){t.label=v(t.data),t.offset=a}),s.scales=[e],s.marks[0].from=function(){return A},s.marks[1].from=function(){return p},s.marks[2].from=s.marks[1].from,s}function i(t,e,n,r){var i=A(),a=_(),s=C();return w(a,t,e,n,r),S.extend(i.properties.update,M),S.extend(a.properties.update,b),S.extend(s.properties.update,L),i.properties.enter.x.value+=m,i.properties.enter.y.value+=m,s.properties.enter.x.offset+=m+1,a.properties.enter.x.offset=m+1,s.properties.update.x.offset+=m+1,a.properties.update.x.offset=m+1,{type:"group",interactive:!1,properties:{enter:S.parse.properties("group",x),update:E},marks:[i,a,s].map(S.parse.mark)}}function a(t){var e=s(t),n=t.domain(),r=n.map(S.data.ingest),i=k.width&&k.width.value||S.config.legend.gradientWidth,a=null==d?t.tickFormat?t.tickFormat.apply(t,y):String:d,o={name:"legend",type:t.type,round:!0,zero:!1,domain:[n[0],n[n.length-1]],range:[m,i+m]};"pow"===t.type&&(o.exponent=t.exponent());var u=(g?[g]:[]).map(S.data.ingest);return r.forEach(function(t,e){t.label=a(t.data),t.align=e==r.length-1?"right":0==e?"left":"center"}),e.scales=[o],e.marks[0].from=function(){return u},e.marks[1].from=function(){return[1]},e.marks[2].from=function(){return r},e}function s(t){var e=A(),n=D(),r=B(),i=new S.Gradient,a=t.domain(),s=a[0],o=a[a.length-1],u=t.copy().domain([s,o]).range([0,1]),l="linear"!==t.type&&t.ticks?t.ticks.call(t,15):a;s!==l[0]&&l.unshift(s),o!==l[l.length-1]&&l.push(o);for(var c=0,h=l.length;h>c;++c)i.stop(u(l[c]),t(l[c]));n.properties.enter.fill={value:i},S.extend(e.properties.update,M),S.extend(n.properties.update,k),S.extend(r.properties.update,L);var f=n.properties,d=k.height,p=d&&d.value||f.enter.height.value;if(r.properties.enter.y.value=p,r.properties.update.y.value=p,g){var v=e.properties,F=M.fontSize,y=4+(F&&F.value||v.enter.fontSize.value);n.properties.enter.y.value+=y,r.properties.enter.y.value+=y,n.properties.update.y.value+=y,r.properties.update.y.value+=y}return e.properties.enter.x.value+=m,e.properties.enter.y.value+=m,n.properties.enter.x.value+=m,n.properties.enter.y.value+=m,r.properties.enter.y.value+=m,n.properties.update.x.value+=m,n.properties.update.y.value+=m,r.properties.update.y.value+=m,{type:"group",interactive:!1,properties:{enter:S.parse.properties("group",x),update:E},marks:[e,n,r].map(S.parse.mark)}}var o=null,u=null,l=null,c=null,h=null,f=null,d=null,p=null,g=void 0,v="right",F=S.config.legend.offset,m=S.config.legend.padding,y=[5],x={},b={},k={},M={},L={},z={},I=null;return z.def=function(){var e=o||u||l||c;return d=p?"time"===e.type?t.time.format(p):t.format(p):null,I||(I=e!==l&&e!==c||n(e.type)?r(e):a(e)),I.orient=v,I.offset=F,I.padding=m,I},z.size=function(t){return arguments.length?(o!==t&&(o=t,e()),z):o},z.shape=function(t){return arguments.length?(u!==t&&(u=t,e()),z):u},z.fill=function(t){return arguments.length?(l!==t&&(l=t,e()),z):l},z.stroke=function(t){return arguments.length?(c!==t&&(c=t,e()),z):c},z.title=function(t){return arguments.length?(g!==t&&(g=t,e()),z):g},z.format=function(t){return arguments.length?(p!==t&&(p=t,e()),z):p},z.spacing=function(t){return arguments.length?(h!==+t&&(h=+t,e()),z):h},z.orient=function(t){return arguments.length?(v=t in $?t+"":S.config.legend.orient,z):v},z.offset=function(t){return arguments.length?(F=+t,z):F},z.values=function(t){return arguments.length?(f=t,z):f},z.legendProperties=function(t){return arguments.length?(x=t,z):x},z.symbolProperties=function(t){return arguments.length?(b=t,z):b},z.gradientProperties=function(t){return arguments.length?(k=t,z):k},z.labelProperties=function(t){return arguments.length?(L=t,z):L},z.titleProperties=function(t){return arguments.length?(M=t,z):M},z.reset=function(){e()},z};var $={right:1,left:1};return S.Model=function(){function t(){this._defs=null,this._data={},this._scene=null,this._reset={axes:!1,legends:!1}}var e=t.prototype;return e.defs=function(t){return arguments.length?(this._defs=t,this):this._defs},e.data=function(t){function e(t){(o[t]||[]).forEach(function(n){a[n]=t,e(n)})}if(!arguments.length)return this._data;var n,r,i,a={},s=this._defs,o=s.data.source,l=s.data.flow||{},h=s.data.sorted,f=h.length;for(S.keys(t).forEach(e),n=0;f>n;++n){if(t[r=h[n]])i=t[r];else{if(!a[r])continue;i=c(this._data[a[r]]),S.isTree(t)&&u(i)}this._data[r]=l[r]?l[r](i,this._data,s.marks):i}return this._reset.legends=!0,this},e.width=function(t){return this._defs&&(this._defs.width=t),this._defs&&this._defs.marks&&(this._defs.marks.width=t),this._scene&&(this._scene.items[0].width=t),this._reset.axes=!0,this},e.height=function(t){return this._defs&&(this._defs.height=t),this._defs&&this._defs.marks&&(this._defs.marks.height=t),this._scene&&(this._scene.items[0].height=t),this._reset.axes=!0,this},e.scene=function(t){return arguments.length?(this._scene=t,this):this._scene},e.build=function(){var t=this,e=t._data,n=t._defs.marks;return t._scene=S.scene.build.call(t,n,e,t._scene),t._scene.items[0].width=n.width,t._scene.items[0].height=n.height,t._scene.interactive=!1,this},e.encode=function(t,e,n,r){this.reset();var i=this,a=i._scene,s=i._defs;return S.scene.encode.call(i,a,s.marks,t,e,n,r),this},e.reset=function(){return this._scene&&this._reset.axes&&(S.scene.visit(this._scene,function(t){t.axes&&t.axes.forEach(function(t){t.reset()})}),this._reset.axes=!1),this._scene&&this._reset.legends&&(S.scene.visit(this._scene,function(t){t.legends&&t.legends.forEach(function(t){t.reset()})}),this._reset.legends=!1),this},t}(),S.View=function(){var e=function(t,e,n){this._el=null,this._build=!1,this._model=new S.Model,this._width=this.__width=e||500,this._height=this.__height=n||500,this._bgcolor=null,this._autopad=1,this._padding={top:0,left:0,bottom:0,right:0},this._viewport=null,this._renderer=null,this._handler=null,this._io=S.canvas,t&&this.initialize(t)},n=e.prototype;return n.width=function(t){return arguments.length?(this.__width!==t&&(this._width=this.__width=t,this._el&&this.initialize(this._el.parentNode),this._model.width(t),this._strict&&(this._autopad=1)),this):this.__width},n.height=function(t){return arguments.length?(this.__height!==t&&(this._height=this.__height=t,this._el&&this.initialize(this._el.parentNode),this._model.height(this._height),this._strict&&(this._autopad=1)),this):this.__height},n.background=function(t){return arguments.length?(this._bgcolor!==t&&(this._bgcolor=t,this._el&&this.initialize(this._el.parentNode)),this):this._bgcolor},n.padding=function(t){return arguments.length?(this._padding!==t&&(S.isString(t)?(this._autopad=1,this._padding={top:0,left:0,bottom:0,right:0},this._strict="strict"===t):(this._autopad=0,this._padding=t,this._strict=!1),this._el&&(this._renderer.resize(this._width,this._height,t),this._handler.padding(t))),this):this._padding},n.autopad=function(t){if(this._autopad<1)return this;this._autopad=0;var e=this._padding,n=this.model().scene().bounds,r=S.config.autopadInset,i=n.x1<0?Math.ceil(-n.x1)+r:0,a=n.y1<0?Math.ceil(-n.y1)+r:0,s=n.x2>this._width?Math.ceil(+n.x2-this._width)+r:0;return e={left:i,top:a,right:s,bottom:n=n.y2>this._height?Math.ceil(+n.y2-this._height)+r:0},this._strict?(this._autopad=0,this._padding=e,this._width=Math.max(0,this.__width-(i+s)),this._height=Math.max(0,this.__height-(a+n)),this._model.width(this._width),this._model.height(this._height),this._el&&this.initialize(this._el.parentNode),this.update({props:"enter"}).update({props:"update"})):this.padding(e).update(t),this},n.viewport=function(t){return arguments.length?(this._viewport!==t&&(this._viewport=t,this._el&&this.initialize(this._el.parentNode)),this):this._viewport},n.renderer=function(t){return arguments.length?("canvas"===t&&(t=S.canvas),"svg"===t&&(t=S.svg),this._io!==t&&(this._io=t,this._renderer=null,this._el&&this.initialize(this._el.parentNode),this._build&&this.render()),this):this._io},n.defs=function(t){return arguments.length?(this._model.defs(t),this):this._model.defs()},n.data=function(t){if(!arguments.length)return this._model.data();var e=S.keys(t).reduce(function(e,n){return e[n]=S.data.ingestAll(t[n]),e},{});return this._model.data(e),this._build=!1,this},n.model=function(t){return arguments.length?(this._model!==t&&(this._model=t,this._handler&&this._handler.model(t)),this):this._model},n.initialize=function(e){var n,r=this,i=r._width,a=r._height,s=r._bgcolor,o=r._padding;return t.select(e).select("div.vega").remove(),this._el=e=t.select(e).append("div").attr("class","vega").style("position","relative").node(),r._viewport&&t.select(e).style("width",(r._viewport[0]||i)+"px").style("height",(r._viewport[1]||a)+"px").style("overflow","auto"),r._renderer=(r._renderer||new this._io.Renderer).initialize(e,i,a,o,s),n=r._handler,r._handler=(new this._io.Handler).initialize(e,o,r).model(r._model),n&&n.handlers().forEach(function(t){r._handler.on(t.type,t.handler)}),this},n.render=function(t){return this._renderer.render(this._model.scene(),t),this},n.on=function(){return this._handler.on.apply(this._handler,arguments),this},n.off=function(){return this._handler.off.apply(this._handler,arguments),this},n.update=function(t){var e=this,n=(t=t||{}).duration?S.scene.transition(t.duration,t.ease):null;return e._build=e._build||(e._model.build(),!0),e._model.encode(n,t.props,t.items,t.legend),n?n.start(function(t){e._renderer.render(e._model.scene(),t)}):e.render(t.items),e.autopad(t)},e}(),S.ViewFactory=function(t){
return function(e){e=e||{};var n=(new S.View).width(t.width).height(t.height).background(t.background).padding(t.padding).viewport(t.viewport).renderer(e.renderer||"canvas").defs(t);return t.data.load&&n.data(t.data.load),e.data&&n.data(e.data),e.el&&n.initialize(e.el),!1!==e.hover&&n.on("mouseover",function(t,e){e.hasPropertySet("hover")&&this.update({props:"hover",items:e})}).on("mouseout",function(t,e){e.hasPropertySet("hover")&&this.update({props:"update",items:e})}),n}},S.Spec=function(){var t=function(t){this.spec={width:500,height:500,padding:0,data:[],scales:[],axes:[],marks:[]},t&&S.extend(this.spec,t)},e=t.prototype;return e.width=function(t){return this.spec.width=t,this},e.height=function(t){return this.spec.height=t,this},e.padding=function(t){return this.spec.padding=t,this},e.viewport=function(t){return this.spec.viewport=t,this},e.data=function(t,e){return e?e.name=t:e=S.isString(t)?{name:t}:t,this.spec.data.push(e),this},e.scale=function(t,e){return e?e.name=t:e=S.isString(t)?{name:t}:t,this.spec.scales.push(e),this},e.axis=function(t){return this.spec.axes.push(t),this},e.mark=function(t,e){e?e.type=t:e={type:t},e.properties={},this.spec.marks.push(e);var n=this;return{from:function(t,n){return e.from=n?(n.data=t,n):S.isString(t)?{data:t}:t,this},prop:function(t,n){return e.properties[t]=S.keys(n).reduce(function(t,e){var r=n[e];return t[e]=S.isObject(r)?r:{value:r},t},{}),this},done:function(){return n}}},e.parse=function(t){S.parse.spec(this.spec,t)},e.json=function(){return this.spec},t}(),S.spec=function(t){return new S.Spec(t)},S.headless={},S.headless.canvas=S.canvas.Renderer,S.headless.svg=function(){function e(t,e,n){var r="<"+t;if(e)for(var i in e){var a=e[i];null!=a&&(r+=" "+i+'="'+a+'"')}return n&&(r+=" "+n),r+">"}function n(t){return"</"+t+">"}function r(t){return(t=null==t?"":String(t)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function i(t){return String(t).replace(/\"/g,"'")}function a(t){var r=t.width||0,i=t.height||0;return 0===r&&0===i?"":e("rect",{"class":"background",width:r,height:i},E(t,"rect"))+n("rect")}function s(t,e){var n={transform:"translate("+(t.x||0)+","+(t.y||0)+")"};if(t.clip){var r={width:t.width||0,height:t.height||0},i=t.clip_id||(t.clip_id="clip"+I++);e.clipping[i]=r,n["clip-path"]="url(#"+i+")"}return n}function o(t){return{transform:"translate("+(t.x||0)+","+(t.y||0)+")",d:D(t)}}function u(t){if(t.length){var e=t[0],n="horizontal"===e.orient?M:B;return n.interpolate(e.interpolate||"linear").tension(null==e.tension?.7:e.tension),{d:n(t)}}}function l(t){if(t.length){var e=t[0];return L.interpolate(e.interpolate||"linear").tension(null==e.tension?.7:e.tension),{d:L(t)}}}function c(t){return{transform:"translate("+(t.x||0)+","+(t.y||0)+")",d:t.path}}function h(t){return{x:t.x||0,y:t.y||0,width:t.width||0,height:t.height||0}}function f(t){var e=t.x||0,n=t.y||0;return{x1:e,y1:n,x2:null!=t.x2?t.x2:e,y2:null!=t.y2?t.y2:n}}function d(t){return{transform:"translate("+(t.x||0)+","+(t.y||0)+")",d:z(t)}}function p(t){var e=t.width||t.image&&t.image.width||0,n=t.height||t.image&&t.image.height||0,r=t.x-("center"===t.align?e/2:"right"===t.align?e:0),i=t.y-("middle"===t.baseline?n/2:"bottom"===t.baseline?n:0);return{"xlink:href":S.config.baseURL+t.url,x:r,y:i,width:e,height:n}}function g(t){var e=t.x||0,n=t.y||0,r=t.dx||0,i=t.dy||0,a=t.angle||0,s=t.radius||0,o=P[t.align||"left"],u="top"===t.baseline?".9em":"middle"===t.baseline?".35em":0;if(s){var l=(t.theta||0)-Math.PI/2;e+=s*Math.cos(l),n+=s*Math.sin(l)}return{x:e+r,y:n+i,"text-anchor":o,transform:a?"rotate("+a+" "+e+","+n+")":null,dy:u||null}}function v(t){var e="type-"+t.type;return t.name&&(e+=" "+t.name),e}function F(t){return t.x||0}function m(t){return t.y||0}function y(t){return t.x+t.width||0}function x(t){return t.y+t.height||0}function b(t){return null==t.size?100:t.size}function k(t){return t.shape||"circle"}function E(t,e,n){var r,i,a,s,o,u=t.mark?t:t.length?t[0]:null;if(null===u)return null;var l="";for(r=0,i=O.length;i>r;++r)a=O[r],s=T[a],null==(o=u[a])?"fill"===s&&(l+="fill:none;"):(o.id&&(n.gradient[o.id]=o,o="url("+window.location.href+"#"+o.id+")"),l+=s+":"+o+";");return"text"===e&&(l+="font:"+w(u)),l.length?'style="'+l+'"':null}function w(t){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+(null!=t.fontSize?t.fontSize:S.config.render.fontSize)+"px "+(t.font&&i(t.font)||S.config.render.font)}var A=function(){this._text={head:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}},_=A.prototype;_.initialize=function(t,r,i,a,s){var o=this._text,u={width:r,height:i};null!=s&&(u.style="background-color:"+s+";"),o.head=e("svg",u,S.config.svgNamespace),o.root=e("g",{transform:"translate("+a.left+","+a.top+")"}),o.foot=n("g")+n("svg")},_.svg=function(){var t=this._text;return t.head+t.defs+t.root+t.body+t.foot},_.buildDefs=function(){var t,r,i=this._defs,a=S.keys(i.gradient),s=S.keys(i.clipping),o="";for(t=0;t<a.length;++t){var u=a[t],l=(c=i.gradient[u]).stops;for(o+=e("linearGradient",{id:u,x1:c.x1,x2:c.x2,y1:c.y1,y2:c.y2}),r=0;r<l.length;++r)o+=e("stop",{offset:l[r].offset,"stop-color":l[r].color})+n("stop");o+=n("linearGradient")}for(t=0;t<s.length;++t){u=s[t];var c=i.clipping[u];o+=e("clipPath",{id:u}),o+=e("rect",{x:0,y:0,width:c.width,height:c.height})+n("rect"),o+=n("clipPath")}return o},_.render=function(t){this._text.body=this.draw(t),this._text.defs=this.buildDefs()},_.draw=function(t){var i,a,s=C[t.marktype],o=s[0],u=s[1],l=s[2]||!1?[t.items]:t.items,c=this._defs,h="";for(h+=e("g",{"class":v(t.def)}),i=0;i<l.length;++i)a="g"===o?null:E(l[i],o,c),h+=e(o,u(l[i],c),a),"text"===o&&(h+=r(l[i].text)),"g"===o&&(h+=this.drawGroup(l[i])),h+=n(o);return h+n("g")};var C={group:["g",s],area:["path",u,!0],line:["path",l,!0],arc:["path",o],path:["path",c],symbol:["path",d],rect:["rect",h],rule:["line",f],text:["text",g],image:["image",p]};_.drawGroup=function(t){var e,n,r="",i=t.axisItems||[],s=t.items,o=t.legendItems||[];for(r+=a(t),e=0,n=i.length;n>e;++e)"back"===i[e].def.layer&&(r+=this.draw(i[e]));for(e=0,n=s.length;n>e;++e)r+=this.draw(s[e]);for(e=0,n=i.length;n>e;++e)"back"!==i[e].def.layer&&(r+=this.draw(i[e]));for(e=0,n=o.length;n>e;++e)r+=this.draw(o[e]);return r};var D=t.svg.arc(),B=t.svg.area().x(F).y1(m).y0(x),M=t.svg.area().y(m).x0(y).x1(F),L=t.svg.line().x(F).y(m),z=t.svg.symbol().type(k).size(b),I=0,P={left:"start",center:"middle",right:"end"},T={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeWidth:"stroke-width",strokeOpacity:"stroke-opacity",strokeCap:"stroke-linecap",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",opacity:"opacity"},O=S.keys(T);return A}(),S.headless.View=function(){var t=function(t,e,n,r,i,a){this._canvas=null,this._type=i,this._el="body",this._build=!1,this._model=new S.Model,this._width=this.__width=t||500,this._height=this.__height=e||500,this._bgcolor=r||null,this._padding=n||{top:0,left:0,bottom:0,right:0},this._autopad=S.isString(this._padding)?1:0,this._renderer=new S.headless[i],this._viewport=a||null,this.initialize()},e=t.prototype;return e.el=function(t){return arguments.length?(this._el!==t&&(this._el=t,this.initialize()),this):this._el},e.model=function(){return this._model},e.width=function(t){return arguments.length?(this._width!==t&&(this._width=t,this.initialize(),this._model.width(t)),this):this._width},e.height=function(t){return arguments.length?(this._height!==t&&(this._height=t,this.initialize(),this._model.height(this._height)),this):this._height},e.background=function(t){return arguments.length?(this._bgcolor!==t&&(this._bgcolor=t,this.initialize()),this):this._bgcolor},e.padding=function(t){return arguments.length?(this._padding!==t&&(S.isString(t)?(this._autopad=1,this._padding={top:0,left:0,bottom:0,right:0},this._strict="strict"===t):(this._autopad=0,this._padding=t,this._strict=!1),this.initialize()),this):this._padding},e.autopad=function(t){if(this._autopad<1)return this;this._autopad=0;var e=this._padding,n=this._model.scene().bounds,r=S.config.autopadInset,i=n.x1<0?Math.ceil(-n.x1)+r:0,a=n.y1<0?Math.ceil(-n.y1)+r:0,s=n.x2>this._width?Math.ceil(+n.x2-this._width)+r:0;return e={left:i,top:a,right:s,bottom:n=n.y2>this._height?Math.ceil(+n.y2-this._height)+r:0},this._strict?(this._autopad=0,this._padding=e,this._width=Math.max(0,this.__width-(i+s)),this._height=Math.max(0,this.__height-(a+n)),this._model.width(this._width),this._model.height(this._height),this._el&&this.initialize(),this.update({props:"enter"}).update({props:"update"})):this.padding(e).update(t),this},e.viewport=function(t){return arguments.length?(this._viewport=t,this.initialize(),this):_viewport},e.defs=function(t){return arguments.length?(this._model.defs(t),this):this._model.defs()},e.data=function(t){if(!arguments.length)return this._model.data();var e=S.keys(t).reduce(function(e,n){return e[n]=S.data.ingestAll(t[n]),e},{});return this._model.data(e),this._build=!1,this},e.renderer=function(){return this._renderer},e.canvas=function(){return this._canvas},e.canvasAsync=function(t){function e(){0===n.pendingImages()?(r.render(),t(r._canvas)):setTimeout(e,10)}var n=this._renderer,r=this;n.pendingImages()>0?e():t(this._canvas)},e.svg=function(){return"svg"===this._type?this._renderer.svg():null},e.initialize=function(){var t=this._width,e=this._height,n=this._bgcolor,r=this._padding;return this._viewport&&(t=this._viewport[0]-(r?r.left+r.right:0),e=this._viewport[1]-(r?r.top+r.bottom:0)),"svg"===this._type?this.initSVG(t,e,r,n):this.initCanvas(t,e,r,n),this},e.initCanvas=function(t,e,n,r){var i=require("canvas"),a=t+(n?n.left+n.right:0),s=e+(n?n.top+n.bottom:0),o=(this._canvas=new i(a,s)).getContext("2d");o.setTransform(1,0,0,1,n.left,n.top),this._renderer.context(o),this._renderer.resize(t,e,n),this._renderer.background(r)},e.initSVG=function(t,e,n,r){var i=t+(n?n.left+n.right:0),a=e+(n?n.top+n.bottom:0);this._renderer.initialize(this._el,i,a,n,r)},e.render=function(t){return this._renderer.render(this._model.scene(),t),this},e.update=function(t){t=t||{};var e=this;return e._build=e._build||(e._model.build(),!0),e._model.encode(null,t.props,t.items),e.render(t.items),e.autopad(t)},t}(),S.headless.View.Factory=function(t){return function(e){e=e||{};var n=t.width,r=t.height,i=t.padding,a=t.background,s=t.viewport,o=e.renderer||"canvas",u=new S.headless.View(n,r,i,a,o,s).defs(t);return t.data.load&&u.data(t.data.load),e.data&&u.data(e.data),u}},S.headless.render=function(t,e){function n(n){try{var r=n({data:t.data,renderer:t.renderer}).update();"svg"===t.renderer?e(null,{svg:r.svg(),view:r}):r.canvasAsync(function(t){e(null,{canvas:t,view:r})})}catch(a){e(a,null)}}S.parse.spec(t.spec,n,S.headless.View.Factory)},vegaColors(S),S}function vegaColors(t){t.config.range={shapes:["circle","cross","diamond","square","triangle-down","triangle-up"],category10:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],category20:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],category20b:["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],category20c:["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"],hgdefault:["#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F"],parula:["#352A87","#363093","#3637A0","#353DAD","#3243BA","#2C4AC7","#2053D4","#0F5CDD","#0363E1","#0268E1","#046DE0","#0871DE","#0D75DC","#1079DA","#127DD8","#1481D6","#1485D4","#1389D3","#108ED2","#0C93D2","#0998D1","#079CCF","#06A0CD","#06A4CA","#06A7C6","#07A9C2","#0AACBE","#0FAEB9","#15B1B4","#1DB3AF","#25B5A9","#2EB7A4","#38B99E","#42BB98","#4DBC92","#59BD8C","#65BE86","#71BF80","#7CBF7B","#87BF77","#92BF73","#9CBF6F","#A5BE6B","#AEBE67","#B7BD64","#C0BC60","#C8BC5D","#D1BB59","#D9BA56","#E1B952","#E9B94E","#F1B94A","#F8BB44","#FDBE3D","#FFC337","#FEC832","#FCCE2E","#FAD32A","#F7D826","#F5DE21","#F5E41D","#F5EB18","#F6F313","#F9FB0E"],jet:["#00008F","#00009F","#0000AF","#0000BF","#0000CF","#0000DF","#0000EF","#0000FF","#0010FF","#0020FF","#0030FF","#0040FF","#0050FF","#0060FF","#0070FF","#0080FF","#008FFF","#009FFF","#00AFFF","#00BFFF","#00CFFF","#00DFFF","#00EFFF","#00FFFF","#10FFEF","#20FFDF","#30FFCF","#40FFBF","#50FFAF","#60FF9F","#70FF8F","#80FF80","#8FFF70","#9FFF60","#AFFF50","#BFFF40","#CFFF30","#DFFF20","#EFFF10","#FFFF00","#FFEF00","#FFDF00","#FFCF00","#FFBF00","#FFAF00","#FF9F00","#FF8F00","#FF8000","#FF7000","#FF6000","#FF5000","#FF4000","#FF3000","#FF2000","#FF1000","#FF0000","#EF0000","#DF0000","#CF0000","#BF0000","#AF0000","#9F0000","#8F0000","#800000"],hsv:["#FF0000","#FF1800","#FF3000","#FF4800","#FF6000","#FF7800","#FF8F00","#FFA700","#FFBF00","#FFD700","#FFEF00","#F7FF00","#DFFF00","#C7FF00","#AFFF00","#97FF00","#80FF00","#68FF00","#50FF00","#38FF00","#20FF00","#08FF00","#00FF10","#00FF28","#00FF40","#00FF58","#00FF70","#00FF87","#00FF9F","#00FFB7","#00FFCF","#00FFE7","#00FFFF","#00E7FF","#00CFFF","#00B7FF","#009FFF","#0087FF","#0070FF","#0058FF","#0040FF","#0028FF","#0010FF","#0800FF","#2000FF","#3800FF","#5000FF","#6800FF","#8000FF","#9700FF","#AF00FF","#C700FF","#DF00FF","#F700FF","#FF00EF","#FF00D7","#FF00BF","#FF00A7","#FF008F","#FF0078","#FF0060","#FF0048","#FF0030","#FF0018"],hot:["#0B0000","#150000","#200000","#2B0000","#350000","#400000","#4A0000","#550000","#600000","#6A0000","#750000","#800000","#8A0000","#950000","#9F0000","#AA0000","#B50000","#BF0000","#CA0000","#D50000","#DF0000","#EA0000","#F40000","#FF0000","#FF0B00","#FF1500","#FF2000","#FF2B00","#FF3500","#FF4000","#FF4A00","#FF5500","#FF6000","#FF6A00","#FF7500","#FF8000","#FF8A00","#FF9500","#FF9F00","#FFAA00","#FFB500","#FFBF00","#FFCA00","#FFD500","#FFDF00","#FFEA00","#FFF400","#FFFF00","#FFFF10","#FFFF20","#FFFF30","#FFFF40","#FFFF50","#FFFF60","#FFFF70","#FFFF80","#FFFF8F","#FFFF9F","#FFFFAF","#FFFFBF","#FFFFCF","#FFFFDF","#FFFFEF","#FFFFFF"],cool:["#00FFFF","#04FBFF","#08F7FF","#0CF3FF","#10EFFF","#14EBFF","#18E7FF","#1CE3FF","#20DFFF","#24DBFF","#28D7FF","#2DD2FF","#31CEFF","#35CAFF","#39C6FF","#3DC2FF","#41BEFF","#45BAFF","#49B6FF","#4DB2FF","#51AEFF","#55AAFF","#59A6FF","#5DA2FF","#619EFF","#659AFF","#6996FF","#6D92FF","#718EFF","#758AFF","#7986FF","#7D82FF","#827DFF","#8679FF","#8A75FF","#8E71FF","#926DFF","#9669FF","#9A65FF","#9E61FF","#A25DFF","#A659FF","#AA55FF","#AE51FF","#B24DFF","#B649FF","#BA45FF","#BE41FF","#C23DFF","#C639FF","#CA35FF","#CE31FF","#D22DFF","#D728FF","#DB24FF","#DF20FF","#E31CFF","#E718FF","#EB14FF","#EF10FF","#F30CFF","#F708FF","#FB04FF","#FF00FF"],spring:["#FF00FF","#FF04FB","#FF08F7","#FF0CF3","#FF10EF","#FF14EB","#FF18E7","#FF1CE3","#FF20DF","#FF24DB","#FF28D7","#FF2DD2","#FF31CE","#FF35CA","#FF39C6","#FF3DC2","#FF41BE","#FF45BA","#FF49B6","#FF4DB2","#FF51AE","#FF55AA","#FF59A6","#FF5DA2","#FF619E","#FF659A","#FF6996","#FF6D92","#FF718E","#FF758A","#FF7986","#FF7D82","#FF827D","#FF8679","#FF8A75","#FF8E71","#FF926D","#FF9669","#FF9A65","#FF9E61","#FFA25D","#FFA659","#FFAA55","#FFAE51","#FFB24D","#FFB649","#FFBA45","#FFBE41","#FFC23D","#FFC639","#FFCA35","#FFCE31","#FFD22D","#FFD728","#FFDB24","#FFDF20","#FFE31C","#FFE718","#FFEB14","#FFEF10","#FFF30C","#FFF708","#FFFB04","#FFFF00"],summer:["#008066","#048266","#088466","#0C8666","#108866","#148A66","#188C66","#1C8E66","#209066","#249266","#289466","#2D9666","#319866","#359A66","#399C66","#3D9E66","#41A066","#45A266","#49A466","#4DA666","#51A866","#55AA66","#59AC66","#5DAE66","#61B066","#65B266","#69B466","#6DB666","#71B866","#75BA66","#79BC66","#7DBE66","#82C066","#86C266","#8AC466","#8EC666","#92C866","#96CA66","#9ACC66","#9ECE66","#A2D066","#A6D266","#AAD466","#AED766","#B2D966","#B6DB66","#BADD66","#BEDF66","#C2E166","#C6E366","#CAE566","#CEE766","#D2E966","#D7EB66","#DBED66","#DFEF66","#E3F166","#E7F366","#EBF566","#EFF766","#F3F966","#F7FB66","#FBFD66","#FFFF66"],autumn:["#FF0000","#FF0400","#FF0800","#FF0C00","#FF1000","#FF1400","#FF1800","#FF1C00","#FF2000","#FF2400","#FF2800","#FF2D00","#FF3100","#FF3500","#FF3900","#FF3D00","#FF4100","#FF4500","#FF4900","#FF4D00","#FF5100","#FF5500","#FF5900","#FF5D00","#FF6100","#FF6500","#FF6900","#FF6D00","#FF7100","#FF7500","#FF7900","#FF7D00","#FF8200","#FF8600","#FF8A00","#FF8E00","#FF9200","#FF9600","#FF9A00","#FF9E00","#FFA200","#FFA600","#FFAA00","#FFAE00","#FFB200","#FFB600","#FFBA00","#FFBE00","#FFC200","#FFC600","#FFCA00","#FFCE00","#FFD200","#FFD700","#FFDB00","#FFDF00","#FFE300","#FFE700","#FFEB00","#FFEF00","#FFF300","#FFF700","#FFFB00","#FFFF00"],winter:["#0000FF","#0004FD","#0008FB","#000CF9","#0010F7","#0014F5","#0018F3","#001CF1","#0020EF","#0024ED","#0028EB","#002DE9","#0031E7","#0035E5","#0039E3","#003DE1","#0041DF","#0045DD","#0049DB","#004DD9","#0051D7","#0055D5","#0059D2","#005DD0","#0061CE","#0065CC","#0069CA","#006DC8","#0071C6","#0075C4","#0079C2","#007DC0","#0082BE","#0086BC","#008ABA","#008EB8","#0092B6","#0096B4","#009AB2","#009EB0","#00A2AE","#00A6AC","#00AAAA","#00AEA8","#00B2A6","#00B6A4","#00BAA2","#00BEA0","#00C29E","#00C69C","#00CA9A","#00CE98","#00D296","#00D794","#00DB92","#00DF90","#00E38E","#00E78C","#00EB8A","#00EF88","#00F386","#00F784","#00FB82","#00FF80"],gray:["#000000","#040404","#080808","#0C0C0C","#101010","#141414","#181818","#1C1C1C","#202020","#242424","#282828","#2D2D2D","#313131","#353535","#393939","#3D3D3D","#414141","#454545","#494949","#4D4D4D","#515151","#555555","#595959","#5D5D5D","#616161","#656565","#696969","#6D6D6D","#717171","#757575","#797979","#7D7D7D","#828282","#868686","#8A8A8A","#8E8E8E","#929292","#969696","#9A9A9A","#9E9E9E","#A2A2A2","#A6A6A6","#AAAAAA","#AEAEAE","#B2B2B2","#B6B6B6","#BABABA","#BEBEBE","#C2C2C2","#C6C6C6","#CACACA","#CECECE","#D2D2D2","#D7D7D7","#DBDBDB","#DFDFDF","#E3E3E3","#E7E7E7","#EBEBEB","#EFEFEF","#F3F3F3","#F7F7F7","#FBFBFB","#FFFFFF"],bone:["#000001","#040406","#07070B","#0B0B10","#0E0E15","#12121A","#15151F","#191923","#1C1C28","#20202D","#232332","#272737","#2B2B3C","#2E2E41","#323246","#35354A","#39394F","#3C3C54","#404059","#43435E","#474763","#4A4A68","#4E4E6C","#515171","#555675","#595B78","#5C607C","#606580","#636A83","#676F87","#6A748A","#6E788E","#717D91","#758295","#788798","#7C8C9C","#80919F","#8396A3","#879BA6","#8A9FAA","#8EA4AE","#91A9B1","#95AEB5","#98B3B8","#9CB8BC","#9FBDBF","#A3C1C3","#A6C6C6","#ACCACA","#B2CDCD","#B7D1D1","#BDD5D5","#C2D8D8","#C8DCDC","#CDDFDF","#D3E3E3","#D8E6E6","#DEEAEA","#E3EDED","#E9F1F1","#EEF4F4","#F4F8F8","#F9FBFB","#FFFFFF"],copper:["#000000","#050302","#0A0604","#0F0906","#140D08","#19100A","#1E130C","#23160E","#281910","#2E1C12","#332014","#382316","#3D2618","#42291A","#472C1C","#4C2F1E","#513320","#563622","#5B3924","#603C26","#653F28","#6A422A","#6F462C","#74492E","#794C30","#7E4F32","#845234","#895536","#8E5938","#935C3A","#985F3C","#9D623E","#A26540","#A76842","#AC6C44","#B16F46","#B67248","#BB754B","#C0784D","#C57B4F","#CA7E51","#CF8253","#D48555","#DA8857","#DF8B59","#E48E5B","#E9915D","#EE955F","#F39861","#F89B63","#FD9E65","#FFA167","#FFA469","#FFA86B","#FFAB6D","#FFAE6F","#FFB171","#FFB473","#FFB775","#FFBB77","#FFBE79","#FFC17B","#FFC47D","#FFC77F"],pink:["#1E0000","#321A1A","#402525","#4B2D2D","#553434","#5E3B3B","#664040","#6E4545","#754A4A","#7B4F4F","#825353","#885757","#8D5B5B","#935F5F","#986262","#9D6666","#A26969","#A76C6C","#AC6F6F","#B07272","#B57575","#B97878","#BD7B7B","#C27E7E","#C38481","#C58A83","#C79086","#C99588","#CA9A8B","#CC9F8D","#CEA490","#CFA992","#D1AE94","#D3B297","#D4B799","#D6BB9B","#D8BF9D","#D9C3A0","#DBC7A2","#DCCBA4","#DECFA6","#DFD3A8","#E1D7AA","#E2DAAC","#E4DEAE","#E5E1B0","#E7E5B2","#E8E8B4","#EAEAB9","#EBEBBF","#EDEDC4","#EEEEC9","#F0F0CE","#F1F1D3","#F3F3D8","#F4F4DD","#F5F5E1","#F7F7E6","#F8F8EA","#FAFAEE","#FBFBF3","#FCFCF7","#FEFEFB","#FFFFFF"],lines:["#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD","#D95319","#EDB120","#7E2F8E","#77AC30","#4DBEEE","#A2142F","#0072BD"]}}var thingSpeakWebplot=function(t){function e(e,r,i){this.helperFunctions=new n,this.internalData={},this.view=null,this.emptySpec={width:425,height:340,scales:[{name:"x",type:"linear",range:"width",domainMin:0,domainMax:10},{name:"y",type:"linear",range:"height",domainMin:0,domainMax:10}],axes:[{type:"x",scale:"x"},{type:"y",scale:"y"}]},this.d3=e,this.topojson=r,this.$=i,this.setDomElement=function(t){if("object"==typeof t){var e=Date.now();t.setAttribute("id",e),t="#"+e}this.internalData.domId=t},this.setSpec=function(t,e){this.schemaCheck(t)||(this.helperFunctions.errorMessage("this json format is not supported"),t=this.emptySpec),this.VERSION=t.version;var n=this;if(e&&this.setDomElement(e),t&&(this.spec=t),this.setScales(t),this.$&&!1!==t.resizableButtonVisible){this.loadResizeLibraries();var r=this;setTimeout(function(){r.$(e).resizable&&r.$(e).resizable({stop:function(t,e){var r=n.getSpec();r.width=e.size.width,r.height=e.size.height,n.setSpec(r),n.render()}})},500)}this.marginY=this.spec.marginY||0,this.marginX=this.spec.marginX||0,this.width=this.spec.width=this.spec.width-this.marginX,this.height=this.spec.height=this.spec.height-this.marginY,this.renderer=this.spec.renderer||"svg"},this.schemaCheck=function(t){if(!(t&&t.data&&t.data.length>=1))return!1;for(var e=0;e<t.data.length;e++){if(!(t.data[e].url||t.data[e].source||t.data[e].values))return!1;if(t.data[e].values&&0===t.data[e].values.length)return!1}return!0},this.getSpec=function(){return this.spec},this.getInternalData=function(){return this.internalData},this.getTooltipClassName=function(){return this.tip.attr("class")},this.loadResizeLibraries=function(){var t=(this.getSpec(),document.createElement("script"));t.src="//code.jquery.com/ui/1.11.4/jquery-ui.min.js",document.getElementsByTagName("head")[0].appendChild(t);var e=document.createElement("link");return e.href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css",e.type="text/css",e.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(e),{script:t.src,style:e.href}},this.loadLibraries=function(e,n,r){this.getSpec(),this.d3||(this.d3=e||t.d3||this.helperFunctions.errorMessage("d3.js is not found")),this.d3&&!this.topojson&&(this.topojson=n||t.topojson||this.helperFunctions.errorMessage("topojson.js is not found")),this.d3&&this.topojson&&!this.vg&&(this.vg=vegaFactory&&vegaFactory(this.d3,this.topojson)||this.helperFunctions.errorMessage("vega.js is not found")),this.$||(this.$=r||t.$||this.helperFunctions.errorMessage("jQuery is not found"))},this.render=function(t){var e=this.getSpec(),n=this.helperFunctions.proxyFn(this,this.parseSpec,t);this.vg.parse.spec(e,n)},this.parseSpec=function(t,e){var n=this.getSpec();null!=t?(this.view=t({el:this.internalData.domId,renderer:this.renderer}),this.view&&"svg"===this.renderer&&(this.viewUpdate(),this.svg=this.d3.select(this.internalData.domId+" svg"),!1!==n.tipEnabled&&(this.attachTip(),this.attachEvents()),!1!==n.interactivity&&(this.attachInteraction(),"time"===this.xScale&&!1!==n.hoverLineOn&&(this.createHoverLine(),this.createDateLabel())),e&&(!0===n.resizable&&this.resized||!1===n.resizable)&&e.call())):this.helperFunctions.errorMessage("vega rendering failed.")},this.forceSize=function(){var t=this.svg.attr("width"),e=this.svg.attr("height"),n=this.d3.select(this.internalData.domId+" rect"),r=this.getSpec();(t>this.width||e>this.height)&&(r.marginX=t-n.attr("width"),r.marginY=e-n.attr("height"),this.setSpec(r))},this.resize=function(){var t=this,e=this.getSpec();"svg"===this.renderer&&e.resizable&&(this.resizeIntervalFunction=setInterval(function(){t.view&&(t.forceSize(),t.render(),clearInterval(t.resizeIntervalFunction),t.resized=!0)},100))},this.viewUpdate=function(t){this.view&&(this.view.update(t),"svg"===this.renderer&&this.appendClip())},this.resetView=function(){this.render()},this.createZoomFunction=function(){var t=this,e=this.view.model().scene().items[0].scales;if(e){var n=this.d3.behavior.zoom().on("zoom",function(){t.view.update({props:"enter",legend:!1}),t.viewUpdate({props:"update",legend:!1}),t.tip&&t.tip.hide()}).x(e.x);return e.y&&(n=n.y(e.y)),n.scaleExtent([1,1/0]).center([this.width/2,this.height/2]).size([this.width,this.height])}},this.attachEvents=function(){var t=this.helperFunctions.proxyFn(this,this.onmouseevents);this.getSpec(),this.view&&(this.view.on("mouseover",t),this.view.on("mouseout",t))},this.attachTip=function(){var t=this.getSpec();this.tip=this.d3.tip().attr("class",t&&t.tooltipClass||"tooltip").direction("e").offset([0,6]).html(t&&t.getTooltipContent||this.helperFunctions.getTooltipContent),this.svg.call(this.tip)},this.attachInteraction=function(){var t=this,e=this.createZoomFunction();this.svg.call(e),this.svg.on("dblclick.zoom",function(){t.resetView()}),this.setChartCursor("move")},this.createHoverLine=function(){var t=this;this.hoverLineGroup=this.svg.select("g").append("svg:g").attr("class","hover-line"),this.hoverLine=this.hoverLineGroup.append("svg:line").attr("x1",10).attr("x2",10).attr("y1",0).attr("y2",this.getSpec().height).classed("hide",!0),this.$(this.internalData.domId).on("mousemove",function(e){t.mouseDown&&(t.isPanning=!0);var n={x:e.pageX-t.hoverLineXOffset,y:e.pageY-t.hoverLineYOffset};t.handleGraphMouseIn(n)}).on("mouseenter",function(e){var n={x:e.pageX-t.hoverLineXOffset,y:e.pageY-t.hoverLineYOffset};t.handleGraphMouseIn(n)}).on("mousedown",function(){t.mouseDown=!0}).on("mouseup",function(){t.mouseDown=!1,t.isPanning=!1});var e=this.$(this.$(this.internalData.domId+" rect")[0]).offset();this.hoverLineXOffset=e.left,this.hoverLineYOffset=e.top},this.createDateLabel=function(){this.svg.select("g").append("svg:g").attr("class","date-label-group").append("svg:text").attr("class","date-label").attr("text-anchor","end").attr("font-size","10").attr("y",-4).attr("x",this.getSpec().width).text("")},this.setChartCursor=function(t){t&&this.svg.style("cursor",t)},this.onmouseevents=function(t,e){"mouseover"===t.type?(this.checkMarkType(e)&&this.tip&&this.tip.show(e.datum,this.xScale,this.yScale,e._svg),e.hasPropertySet("hover")&&this.viewUpdate({props:"hover",items:e})):(this.checkMarkType(e)&&this.tip&&this.tip.hide(),e.hasPropertySet("hover")&&this.viewUpdate({props:"update",items:e}))},this.handleGraphMouseIn=function(t){if(t){var e=t.x,n=t.y,r=this.getSpec(),i=this.view.model().scene().items[0].scales.x;e>0&&e<=r.width&&n>0&&n<=r.height?(this.updateDateTextContent(i.invert(e)),this.redrawHoverLine(e)):this.handleGraphMouseOut()}},this.handleGraphMouseOut=function(){this.clearDateTextContent(),this.hoverLine.classed("hide",!0)},this.redrawHoverLine=function(t){this.hoverLine.classed("hide",!1),this.hoverLine.attr("x1",t).attr("x2",t)},this.checkMarkType=function(t){return!!(t&&t.mark&&t.mark.marktype)&&("symbol"===t.mark.marktype||"path"===t.mark.marktype||"rect"===t.mark.marktype)},this.appendClip=function(){var t;(t=this.svg?this.svg:this.d3.select(this.internalData.domId+" svg")).append("defs").append("svg:clipPath").attr("id","clip").append("svg:rect").attr("id","clip-rect").attr("x","0").attr("y","0").attr("width",this.width).attr("height",this.height),t.selectAll(".type-viz-mark").attr("clip-path","url(#clip)")},this.setScales=function(t){if(t&&t.scales)for(var e=0;e<t.scales.length;e++)"x"===t.scales[e].name?this.xScale=t.scales[e].type:"y"===t.scales[e].name&&(this.yScale=t.scales[e].type)},this.updateDateTextContent=function(t,e){var n=this.getDateLabelNode(e);n&&t?this.isPanning||n.text(new Date(t)):this.helperFunctions.errorMessage("date label is not found.")},this.clearDateTextContent=function(t){var e=this.getDateLabelNode(t);e?this.isPanning||e.text(""):this.helperFunctions.errorMessage("date label is not found.")},this.getDateLabelNode=function(t){var e=this.d3.select("text.date-label");return!e&&t&&(e=t),e}}var n=function(){this.errorMessage=function(t){console.log(t)},this.proxyFn=function(t,e,n){return function(){arguments=Array.prototype.slice.call(arguments),n&&(arguments=arguments.concat(n)),e.apply(t,arguments)}},this.getTooltipContent=function(t,e,n){function r(t){return d3.time.format("%a %b %e %Y")(t)+"<br/>"+d3.time.format("%I:%M:%S %p")(t)+"<br/>"+d3.time.format("GMT%Z")(t)}function i(t){return d3.format(",g")(t)}return"<table><tr valign='top'><td>X:</td><td>"+("time"===e?r(new Date(t.data.x)):i("object"==typeof t.data?t.data.x:t.x))+"</td></tr><tr valign='top'><td>Y:</td><td>"+("time"===n?r(new Date(t.data.y)):i("object"==typeof t.data?t.data.y:t.data))+"</td></tr></table>"}};return"function"==typeof define&&define.amd?void define(["thingspeak_webplot/d3.min","thingspeak_webplot/topojson.min"],function(t,n){return function(){return new e(t,n)}}):e}(this);